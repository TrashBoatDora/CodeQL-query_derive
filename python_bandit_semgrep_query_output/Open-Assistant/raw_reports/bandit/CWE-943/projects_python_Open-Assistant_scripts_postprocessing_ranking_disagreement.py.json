{
  "errors": [],
  "generated_at": "2026-01-10T13:20:20Z",
  "metrics": {
    "./projects/python/Open-Assistant/scripts/postprocessing/ranking_disagreement.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 98,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 98,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "41     message_tree_id = None  # \"'ef458036-ae8e-4ff5-98f2-0f9dfedcb206'\"\n42     query = f\"\"\"\n43         -- get all ranking results of completed tasks for all parents with >= 2 children\n44         SELECT DISTINCT p.parent_id, p.message_tree_id, mr.* FROM\n45         (\n46             -- find parents with > 1 children\n47             SELECT m.parent_id, m.message_tree_id, COUNT(m.id) children_count\n48             FROM message_tree_state mts\n49             INNER JOIN message m ON mts.message_tree_id = m.message_tree_id\n50             WHERE m.review_result                  -- must be reviewed\n51             AND NOT m.deleted                   -- not deleted\n52             AND m.parent_id IS NOT NULL         -- ignore initial prompts\n53             AND ({role} IS NULL OR m.role = {role}) -- children with matching role\n54             -- AND mts.message_tree_id = {message_tree_id}\n55             GROUP BY m.parent_id, m.message_tree_id\n56             HAVING COUNT(m.id) > 1\n57         ) as p\n58         LEFT JOIN task t ON p.parent_id = t.parent_message_id AND t.done AND (t.payload_type = 'RankPrompterRepliesPayload' OR t.payload_type = 'RankAssistantRepliesPayload')\n59         LEFT JOIN message_reaction mr ON mr.task_id = t.id AND mr.payload_type = 'RankingReactionPayload'\n60         \"\"\"\n61 \n",
      "col_offset": 12,
      "end_col_offset": 11,
      "filename": "./projects/python/Open-Assistant/scripts/postprocessing/ranking_disagreement.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 42,
      "line_range": [
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        50,
        51,
        52,
        53,
        54,
        55,
        56,
        57,
        58,
        59,
        60
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    }
  ]
}