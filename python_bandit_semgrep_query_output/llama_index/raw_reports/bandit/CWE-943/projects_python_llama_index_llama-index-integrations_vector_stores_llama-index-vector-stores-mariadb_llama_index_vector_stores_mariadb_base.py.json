{
  "errors": [],
  "generated_at": "2026-01-10T13:32:00Z",
  "metrics": {
    "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 7,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 7,
      "SEVERITY.UNDEFINED": 0,
      "loc": 419,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 7,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 7,
      "SEVERITY.UNDEFINED": 0,
      "loc": 419,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "250 \n251         stmt = f\"\"\"SELECT text, metadata FROM `{self.table_name}` WHERE node_id IN :node_ids\"\"\"\n252 \n",
      "col_offset": 15,
      "end_col_offset": 95,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 251,
      "line_range": [
        251
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "288                 stmt = sqlalchemy.text(\n289                     f\"\"\"\n290                 INSERT INTO `{self.table_name}` (node_id, text, embedding, metadata)\n291                 VALUES (\n292                     :node_id,\n293                     :text,\n294                     VEC_FromText(:embedding),\n295                     :metadata\n296                 )\n297                 \"\"\"\n298                 )\n",
      "col_offset": 20,
      "end_col_offset": 19,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 289,
      "line_range": [
        289,
        290,
        291,
        292,
        293,
        294,
        295,
        296,
        297
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "403 \n404         stmt = f\"\"\"\n405         SET STATEMENT mhnsw_ef_search={self.ef_search} FOR\n406         SELECT\n407             node_id,\n408             text,\n409             embedding,\n410             metadata,\n411             VEC_DISTANCE_COSINE(embedding, VEC_FromText('{query.query_embedding}')) AS distance\n412         FROM `{self.table_name}`\"\"\"\n413 \n",
      "col_offset": 15,
      "end_col_offset": 35,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 404,
      "line_range": [
        404,
        405,
        406,
        407,
        408,
        409,
        410,
        411,
        412
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "443             # Should we create an index on ref_doc_id?\n444             stmt = f\"\"\"DELETE FROM `{self.table_name}` WHERE JSON_EXTRACT(metadata, '$.ref_doc_id') = :doc_id\"\"\"\n445             connection.execute(sqlalchemy.text(stmt), {\"doc_id\": ref_doc_id})\n",
      "col_offset": 19,
      "end_col_offset": 112,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 444,
      "line_range": [
        444
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "457         with self._engine.connect() as connection:\n458             stmt = f\"\"\"DELETE FROM `{self.table_name}` WHERE node_id IN :node_ids\"\"\"\n459             connection.execute(sqlalchemy.text(stmt), {\"node_ids\": node_ids})\n",
      "col_offset": 19,
      "end_col_offset": 84,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 458,
      "line_range": [
        458
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "466         with self._engine.connect() as connection:\n467             stmt = f\"\"\"SELECT COUNT(*) FROM `{self.table_name}`\"\"\"\n468             result = connection.execute(sqlalchemy.text(stmt))\n",
      "col_offset": 19,
      "end_col_offset": 66,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 467,
      "line_range": [
        467
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "486         with self._engine.connect() as connection:\n487             stmt = f\"\"\"DELETE FROM `{self.table_name}`\"\"\"\n488             connection.execute(sqlalchemy.text(stmt))\n",
      "col_offset": 19,
      "end_col_offset": 57,
      "filename": "./projects/python/llama_index/llama-index-integrations/vector_stores/llama-index-vector-stores-mariadb/llama_index/vector_stores/mariadb/base.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 487,
      "line_range": [
        487
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    }
  ]
}