{
  "errors": [],
  "generated_at": "2026-01-10T13:32:48Z",
  "metrics": {
    "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 7,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 7,
      "SEVERITY.UNDEFINED": 0,
      "loc": 324,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 7,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 7,
      "SEVERITY.UNDEFINED": 0,
      "loc": 324,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "169         \"\"\"\n170         query = f\"\"\"\n171             SELECT table_name, table_schema, table_type\n172             FROM `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.TABLES`\n173             WHERE table_type IN ('BASE TABLE', 'VIEW')\n174         \"\"\"\n175         result = self.native_query(query)\n",
      "col_offset": 16,
      "end_col_offset": 11,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 170,
      "line_range": [
        170,
        171,
        172,
        173,
        174
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "189         \"\"\"\n190         query = f\"\"\"\n191             SELECT column_name AS Field, data_type as Type\n192             FROM `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.COLUMNS`\n193             WHERE table_name = '{table_name}'\n194         \"\"\"\n195         result = self.native_query(query)\n",
      "col_offset": 16,
      "end_col_offset": 11,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 190,
      "line_range": [
        190,
        191,
        192,
        193,
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "207         \"\"\"\n208         query = f\"\"\"\n209             SELECT\n210                 t.table_name,\n211                 t.table_schema,\n212                 t.table_type,\n213                 st.row_count\n214             FROM \n215                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.TABLES` AS t\n216             JOIN \n217                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.__TABLES__` AS st\n218             ON \n219                 t.table_name = st.table_id\n220             WHERE \n221                 t.table_type IN ('BASE TABLE', 'VIEW')\n222         \"\"\"\n223 \n",
      "col_offset": 16,
      "end_col_offset": 11,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 208,
      "line_range": [
        208,
        209,
        210,
        211,
        212,
        213,
        214,
        215,
        216,
        217,
        218,
        219,
        220,
        221,
        222
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "240         \"\"\"\n241         query = f\"\"\"\n242             SELECT \n243                 table_name,\n244                 column_name,\n245                 data_type,\n246                 column_default,\n247                 CASE is_nullable\n248                     WHEN 'YES' THEN TRUE\n249                     ELSE FALSE\n250                 END AS is_nullable\n251             FROM \n252                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.COLUMNS`\n253         \"\"\"\n254 \n",
      "col_offset": 16,
      "end_col_offset": 11,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 241,
      "line_range": [
        241,
        242,
        243,
        244,
        245,
        246,
        247,
        248,
        249,
        250,
        251,
        252,
        253
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "288                 batch_queries.append(\n289                     f\"\"\"\n290                     SELECT\n291                         '{table_name}' AS table_name,\n292                         '{column}' AS column_name,\n293                         SAFE_DIVIDE(COUNTIF({column} IS NULL), COUNT(*)) * 100 AS null_percentage,\n294                         CAST(MIN(`{column}`) AS STRING) AS minimum_value,\n295                         CAST(MAX(`{column}`) AS STRING) AS maximum_value,\n296                         COUNT(DISTINCT {column}) AS distinct_values_count\n297                     FROM\n298                         `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.{table_name}`\n299                     \"\"\"\n300                 )\n",
      "col_offset": 20,
      "end_col_offset": 23,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 289,
      "line_range": [
        289,
        290,
        291,
        292,
        293,
        294,
        295,
        296,
        297,
        298,
        299
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "332         \"\"\"\n333         query = f\"\"\"\n334             SELECT\n335                 tc.table_name,\n336                 kcu.column_name,\n337                 kcu.ordinal_position,\n338                 tc.constraint_name,\n339             FROM\n340                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.TABLE_CONSTRAINTS` AS tc\n341             JOIN\n342                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.KEY_COLUMN_USAGE` AS kcu\n343             ON\n344                 tc.constraint_name = kcu.constraint_name\n345             WHERE\n346                 tc.constraint_type = 'PRIMARY KEY'\n347         \"\"\"\n348 \n",
      "col_offset": 16,
      "end_col_offset": 11,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 333,
      "line_range": [
        333,
        334,
        335,
        336,
        337,
        338,
        339,
        340,
        341,
        342,
        343,
        344,
        345,
        346,
        347
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "365         \"\"\"\n366         query = f\"\"\"\n367             SELECT\n368                 ccu.table_name AS parent_table_name,\n369                 ccu.column_name AS parent_column_name,\n370                 kcu.table_name AS child_table_name,\n371                 kcu.column_name AS child_column_name,\n372                 tc.constraint_name\n373             FROM\n374                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.TABLE_CONSTRAINTS` AS tc\n375             JOIN\n376                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.KEY_COLUMN_USAGE` AS kcu\n377             ON\n378                 tc.constraint_name = kcu.constraint_name\n379             JOIN\n380                 `{self.connection_data[\"project_id\"]}.{self.connection_data[\"dataset\"]}.INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE` AS ccu\n381             ON\n382                 tc.constraint_name = ccu.constraint_name\n383             WHERE\n384                 tc.constraint_type = 'FOREIGN KEY'\n385         \"\"\"\n386 \n",
      "col_offset": 16,
      "end_col_offset": 11,
      "filename": "./projects/python/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 366,
      "line_range": [
        366,
        367,
        368,
        369,
        370,
        371,
        372,
        373,
        374,
        375,
        376,
        377,
        378,
        379,
        380,
        381,
        382,
        383,
        384,
        385
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    }
  ]
}