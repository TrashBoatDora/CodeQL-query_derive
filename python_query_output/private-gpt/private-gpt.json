{
  "CWE-022": {
    "pathlib.Path.open": {
      "private-gpt/tests/fixtures/ingest_helper.py": [
        [
          "ingest_file",
          13,
          19,
          14,
          38,
          14,
          52,
          13,
          21,
          17,
          42
        ]
      ],
      "private-gpt/private_gpt/settings/settings_loader.py": [
        [
          "load_settings_from_profile",
          36,
          47,
          43,
          10,
          43,
          29,
          42,
          12,
          45,
          35
        ]
      ]
    },
    "pathlib.Path.read_text": {
      "private-gpt/private_gpt/components/ingest/ingest_helper.py": [
        [
          "_load_file_to_documents",
          81,
          101,
          92,
          45,
          92,
          65,
          86,
          13,
          92,
          67
        ]
      ]
    },
    "pathlib.Path.is_relative_to": {
      "private-gpt/scripts/ingest_folder.py": [
        [
          "_validate_folder",
          27,
          40,
          39,
          20,
          39,
          61,
          38,
          13,
          39,
          61
        ]
      ]
    },
    "pathlib.Path.iterdir": {
      "private-gpt/scripts/ingest_folder.py": [
        [
          "_find_all_files_in_folder",
          42,
          53,
          47,
          26,
          47,
          44,
          42,
          35,
          47,
          44
        ]
      ]
    },
    "pathlib.Path.exists": {
      "private-gpt/scripts/ingest_folder.py": [
        [
          "_do_ingest_one",
          68,
          77,
          70,
          16,
          70,
          36,
          70,
          16,
          70,
          36
        ]
      ],
      "private-gpt/tests/server/ingest/test_local_ingest.py": [
        [
          "clear_log_file",
          19,
          21,
          20,
          8,
          20,
          35,
          19,
          20,
          20,
          35
        ]
      ]
    },
    "tempfile.NamedTemporaryFile": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          56,
          14,
          56,
          54,
          51,
          22,
          58,
          34
        ]
      ],
      "private-gpt/tests/server/ingest/test_ingest_routes.py": [
        [
          "test_ingest_list_returns_something_after_ingestion",
          22,
          37,
          27,
          10,
          27,
          56,
          23,
          5,
          32,
          39
        ]
      ]
    },
    "pathlib.Path.write_bytes": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          60,
          21,
          60,
          54,
          60,
          45,
          60,
          54
        ]
      ]
    },
    "pathlib.Path.write_text": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          62,
          21,
          62,
          58,
          62,
          21,
          62,
          58
        ]
      ]
    },
    "pathlib.Path.unlink": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          66,
          17,
          66,
          36,
          63,
          17,
          66,
          36
        ],
        [
          "_ingest_data",
          51,
          66,
          66,
          17,
          66,
          36,
          65,
          17,
          66,
          36
        ]
      ]
    },
    "open": {
      "private-gpt/tests/server/ingest/test_local_ingest.py": [
        [
          "create_test_file",
          14,
          16,
          15,
          10,
          15,
          29,
          14,
          22,
          16,
          23
        ],
        [
          "read_log_file",
          24,
          26,
          25,
          10,
          25,
          28,
          24,
          19,
          26,
          23
        ]
      ]
    },
    "os.remove": {
      "private-gpt/tests/server/ingest/test_local_ingest.py": [
        [
          "clear_log_file",
          19,
          21,
          21,
          9,
          21,
          32,
          21,
          9,
          21,
          32
        ]
      ],
      "private-gpt/scripts/utils.py": [
        [
          "wipe_file",
          10,
          13,
          12,
          9,
          12,
          23,
          12,
          9,
          13,
          35
        ],
        [
          "wipe_tree",
          16,
          36,
          28,
          17,
          28,
          36,
          28,
          27,
          28,
          36
        ]
      ]
    },
    "os.makedirs": {
      "private-gpt/tests/server/ingest/test_local_ingest.py": [
        [
          "init_structure",
          29,
          32,
          31,
          5,
          31,
          38,
          29,
          20,
          32,
          46
        ]
      ]
    },
    "os.path.isfile": {
      "private-gpt/scripts/utils.py": [
        [
          "wipe_file",
          10,
          13,
          11,
          8,
          11,
          27,
          10,
          15,
          11,
          27
        ],
        [
          "wipe_tree",
          16,
          36,
          27,
          16,
          27,
          40,
          27,
          31,
          27,
          40
        ]
      ]
    },
    "os.path.exists": {
      "private-gpt/scripts/utils.py": [
        [
          "wipe_tree",
          16,
          36,
          17,
          12,
          17,
          31,
          16,
          15,
          17,
          31
        ]
      ]
    },
    "os.listdir": {
      "private-gpt/scripts/utils.py": [
        [
          "wipe_tree",
          16,
          36,
          21,
          17,
          21,
          32,
          20,
          5,
          24,
          36
        ]
      ]
    },
    "os.path.join": {
      "private-gpt/scripts/utils.py": [
        [
          "wipe_tree",
          16,
          36,
          25,
          21,
          25,
          49,
          24,
          9,
          27,
          17
        ]
      ]
    },
    "os.path.isdir": {
      "private-gpt/scripts/utils.py": [
        [
          "wipe_tree",
          16,
          36,
          29,
          18,
          29,
          41,
          29,
          32,
          29,
          41
        ]
      ]
    },
    "shutil.rmtree": {
      "private-gpt/scripts/utils.py": [
        [
          "wipe_tree",
          16,
          36,
          30,
          17,
          30,
          40,
          30,
          31,
          30,
          40
        ]
      ]
    }
  },
  "CWE-078": {
    "subprocess.run": {
      "private-gpt/tests/server/ingest/test_local_ingest.py": [
        [
          "test_ingest_one_file_in_allowed_folder",
          35,
          56,
          45,
          14,
          50,
          5,
          36,
          5,
          52,
          33
        ],
        [
          "test_ingest_disabled",
          59,
          74,
          67,
          14,
          72,
          5,
          59,
          26,
          74,
          33
        ]
      ]
    }
  },
  "CWE-079": {},
  "CWE-095": {
    "json.loads": {
      "private-gpt/private_gpt/components/embedding/custom/sagemaker.py": [
        [
          "_embed",
          45,
          60,
          58,
          25,
          58,
          48,
          45,
          16,
          60,
          39
        ]
      ],
      "private-gpt/private_gpt/components/llm/custom/sagemaker.py": [
        [
          "complete",
          200,
          225,
          221,
          25,
          221,
          48,
          208,
          13,
          225,
          9
        ],
        [
          "get_stream",
          229,
          260,
          250,
          28,
          250,
          84,
          250,
          28,
          253,
          34
        ]
      ]
    }
  },
  "CWE-113": {},
  "CWE-117": {
    "str.replace": {
      "private-gpt/tests/conftest.py": [
        [
          "_as_module",
          10,
          11,
          11,
          12,
          11,
          41,
          10,
          16,
          11,
          79
        ]
      ]
    },
    "logging.debug": {
      "private-gpt/private_gpt/components/ingest/ingest_component.py": [
        [
          "__del__",
          305,
          316,
          309,
          9,
          309,
          53,
          305,
          17,
          316,
          53
        ],
        [
          "__del__",
          305,
          316,
          313,
          9,
          313,
          64,
          305,
          17,
          316,
          53
        ]
      ]
    },
    "print": {
      "private-gpt/private_gpt/components/embedding/custom/sagemaker.py": [
        [
          "_async_not_implemented_warn_once",
          40,
          43,
          42,
          13,
          42,
          80,
          42,
          13,
          43,
          46
        ]
      ],
      "private-gpt/scripts/utils.py": [
        [
          "wipe_file",
          10,
          13,
          13,
          9,
          13,
          35,
          12,
          9,
          13,
          35
        ],
        [
          "wipe_tree",
          16,
          36,
          18,
          9,
          18,
          48,
          18,
          9,
          19,
          14
        ],
        [
          "wipe_tree",
          16,
          36,
          20,
          5,
          20,
          30,
          20,
          5,
          24,
          36
        ],
        [
          "wipe_tree",
          16,
          36,
          31,
          13,
          31,
          44,
          31,
          13,
          31,
          44
        ],
        [
          "wipe_tree",
          16,
          36,
          33,
          13,
          35,
          13,
          32,
          9,
          36,
          20
        ],
        [
          "wipe",
          55,
          64,
          61,
          17,
          61,
          62,
          61,
          17,
          61,
          62
        ],
        [
          "stats",
          66,
          85,
          74,
          13,
          74,
          56,
          74,
          13,
          74,
          56
        ],
        [
          "stats",
          66,
          85,
          75,
          13,
          75,
          76,
          75,
          13,
          75,
          76
        ],
        [
          "stats",
          66,
          85,
          76,
          13,
          76,
          27,
          76,
          13,
          76,
          27
        ],
        [
          "stats",
          66,
          85,
          81,
          17,
          81,
          80,
          81,
          17,
          81,
          80
        ],
        [
          "stats",
          66,
          85,
          83,
          13,
          83,
          19,
          83,
          13,
          83,
          19
        ],
        [
          "wipe",
          124,
          130,
          128,
          13,
          128,
          53,
          128,
          13,
          128,
          53
        ],
        [
          "wipe",
          124,
          130,
          130,
          13,
          130,
          50,
          129,
          9,
          130,
          50
        ],
        [
          "stats",
          132,
          145,
          133,
          9,
          133,
          50,
          132,
          15,
          135,
          41
        ],
        [
          "stats",
          132,
          145,
          139,
          17,
          139,
          75,
          139,
          17,
          139,
          75
        ],
        [
          "stats",
          132,
          145,
          140,
          17,
          140,
          76,
          140,
          17,
          140,
          76
        ],
        [
          "stats",
          132,
          145,
          141,
          17,
          141,
          84,
          141,
          17,
          141,
          84
        ],
        [
          "stats",
          132,
          145,
          145,
          9,
          145,
          57,
          145,
          9,
          145,
          57
        ],
        [
          "for_each_store",
          156,
          172,
          161,
          17,
          161,
          68,
          161,
          17,
          162,
          24
        ],
        [
          "for_each_store",
          156,
          172,
          170,
          17,
          172,
          17,
          170,
          17,
          172,
          17
        ]
      ],
      "private-gpt/private_gpt/ui/ui.py": [
        [
          "get_model_label",
          503,
          537,
          534,
          29,
          534,
          68,
          534,
          29,
          535,
          39
        ]
      ]
    },
    "json.dumps": {
      "private-gpt/private_gpt/components/embedding/custom/sagemaker.py": [
        [
          "_embed",
          45,
          60,
          52,
          18,
          52,
          43,
          45,
          16,
          60,
          39
        ]
      ],
      "private-gpt/private_gpt/components/llm/custom/sagemaker.py": [
        [
          "complete",
          200,
          225,
          215,
          18,
          215,
          43,
          208,
          13,
          225,
          9
        ],
        [
          "get_stream",
          229,
          260,
          239,
          22,
          239,
          47,
          230,
          20,
          248,
          50
        ]
      ]
    }
  },
  "CWE-326": {},
  "CWE-327": {},
  "CWE-329": {
    "uuid.uuid4": {
      "private-gpt/private_gpt/open_ai/openai_models.py": [
        [
          "from_text",
          56,
          74,
          63,
          20,
          63,
          31,
          57,
          9,
          74,
          9
        ],
        [
          "json_from_delta",
          77,
          98,
          85,
          20,
          85,
          31,
          78,
          9,
          98,
          38
        ]
      ]
    }
  },
  "CWE-347": {
    "secrets.compare_digest": {
      "private-gpt/private_gpt/server/utils/auth.py": [
        [
          "_simple_authentication",
          40,
          45,
          42,
          12,
          42,
          79,
          40,
          28,
          42,
          79
        ]
      ]
    }
  },
  "CWE-377": {
    "pathlib.Path.open": {
      "private-gpt/tests/fixtures/ingest_helper.py": [
        [
          "ingest_file",
          13,
          19,
          14,
          38,
          14,
          52,
          13,
          21,
          17,
          42
        ]
      ],
      "private-gpt/private_gpt/settings/settings_loader.py": [
        [
          "load_settings_from_profile",
          36,
          47,
          43,
          10,
          43,
          29,
          42,
          12,
          45,
          35
        ]
      ]
    },
    "tempfile.NamedTemporaryFile": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          56,
          14,
          56,
          54,
          51,
          22,
          58,
          34
        ]
      ],
      "private-gpt/tests/server/ingest/test_ingest_routes.py": [
        [
          "test_ingest_list_returns_something_after_ingestion",
          22,
          37,
          27,
          10,
          27,
          56,
          23,
          5,
          32,
          39
        ]
      ]
    },
    "pathlib.Path.write_bytes": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          60,
          21,
          60,
          54,
          60,
          45,
          60,
          54
        ]
      ]
    },
    "pathlib.Path.write_text": {
      "private-gpt/private_gpt/server/ingest/ingest_service.py": [
        [
          "_ingest_data",
          51,
          66,
          62,
          21,
          62,
          58,
          62,
          21,
          62,
          58
        ]
      ]
    },
    "open": {
      "private-gpt/tests/server/ingest/test_local_ingest.py": [
        [
          "create_test_file",
          14,
          16,
          15,
          10,
          15,
          29,
          14,
          22,
          16,
          23
        ],
        [
          "read_log_file",
          24,
          26,
          25,
          10,
          25,
          28,
          24,
          19,
          26,
          23
        ]
      ]
    }
  },
  "CWE-502": {
    "json.loads": {
      "private-gpt/private_gpt/components/embedding/custom/sagemaker.py": [
        [
          "_embed",
          45,
          60,
          58,
          25,
          58,
          48,
          45,
          16,
          60,
          39
        ]
      ],
      "private-gpt/private_gpt/components/llm/custom/sagemaker.py": [
        [
          "complete",
          200,
          225,
          221,
          25,
          221,
          48,
          208,
          13,
          225,
          9
        ],
        [
          "get_stream",
          229,
          260,
          250,
          28,
          250,
          84,
          250,
          28,
          253,
          34
        ]
      ]
    }
  },
  "CWE-643": {},
  "CWE-760": {
    "uuid.uuid4": {
      "private-gpt/private_gpt/open_ai/openai_models.py": [
        [
          "from_text",
          56,
          74,
          63,
          20,
          63,
          31,
          57,
          9,
          74,
          9
        ],
        [
          "json_from_delta",
          77,
          98,
          85,
          20,
          85,
          31,
          78,
          9,
          98,
          38
        ]
      ]
    }
  },
  "CWE-918": {},
  "CWE-943": {},
  "CWE-1333": {
    "str.startswith": {
      "private-gpt/private_gpt/paths.py": [
        [
          "_absolute_or_from_project_root",
          7,
          10,
          8,
          8,
          8,
          27,
          7,
          36,
          8,
          27
        ]
      ]
    }
  }
}