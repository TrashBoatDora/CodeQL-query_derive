{
  "CWE-022": {
    "os.path.exists": {
      "MediaCrawler/store/weibo/_store_impl.py": [
        [
          "calculate_number_of_files",
          36,
          48,
          43,
          12,
          43,
          42,
          36,
          31,
          43,
          42
        ]
      ],
      "MediaCrawler/store/tieba/_store_impl.py": [
        [
          "calculate_number_of_files",
          36,
          48,
          43,
          12,
          43,
          42,
          36,
          31,
          43,
          42
        ]
      ],
      "MediaCrawler/store/zhihu/_store_impl.py": [
        [
          "calculate_number_of_files",
          35,
          47,
          42,
          12,
          42,
          42,
          35,
          31,
          42,
          42
        ]
      ],
      "MediaCrawler/store/kuaishou/_store_impl.py": [
        [
          "calculate_number_of_files",
          35,
          47,
          42,
          12,
          42,
          42,
          35,
          31,
          42,
          42
        ]
      ],
      "MediaCrawler/tools/async_file_writer.py": [
        [
          "write_to_csv",
          22,
          30,
          25,
          27,
          25,
          51,
          22,
          28,
          28,
          34
        ],
        [
          "write_single_item_to_json",
          32,
          50,
          36,
          16,
          36,
          40,
          32,
          41,
          36,
          40
        ]
      ],
      "MediaCrawler/tools/cdp_browser.py": [
        [
          "add_stealth_script",
          251,
          262,
          255,
          37,
          255,
          63,
          255,
          37,
          255,
          63
        ]
      ],
      "MediaCrawler/tools/slider_util.py": [
        [
          "__init__",
          30,
          43,
          36,
          16,
          36,
          43,
          30,
          18,
          36,
          43
        ]
      ]
    },
    "os.listdir": {
      "MediaCrawler/store/weibo/_store_impl.py": [
        [
          "calculate_number_of_files",
          36,
          48,
          46,
          67,
          46,
          93,
          46,
          78,
          46,
          93
        ]
      ],
      "MediaCrawler/store/tieba/_store_impl.py": [
        [
          "calculate_number_of_files",
          36,
          48,
          46,
          67,
          46,
          93,
          46,
          78,
          46,
          93
        ]
      ],
      "MediaCrawler/store/zhihu/_store_impl.py": [
        [
          "calculate_number_of_files",
          35,
          47,
          45,
          67,
          45,
          93,
          45,
          78,
          45,
          93
        ]
      ],
      "MediaCrawler/store/kuaishou/_store_impl.py": [
        [
          "calculate_number_of_files",
          35,
          47,
          45,
          67,
          45,
          93,
          45,
          78,
          45,
          93
        ]
      ]
    },
    "pathlib.Path.mkdir": {
      "MediaCrawler/tools/async_file_writer.py": [
        [
          "_get_file_path",
          16,
          20,
          18,
          9,
          18,
          66,
          16,
          24,
          20,
          41
        ]
      ],
      "MediaCrawler/store/bilibili/bilibilli_store_media.py": [
        [
          "save_video",
          52,
          68,
          64,
          9,
          64,
          95,
          52,
          26,
          68,
          114
        ]
      ],
      "MediaCrawler/store/douyin/douyin_store_media.py": [
        [
          "save_image",
          48,
          64,
          60,
          9,
          60,
          95,
          48,
          26,
          64,
          112
        ],
        [
          "save_video",
          95,
          111,
          107,
          9,
          107,
          95,
          95,
          26,
          111,
          112
        ]
      ],
      "MediaCrawler/store/weibo/weibo_store_media.py": [
        [
          "save_image",
          52,
          68,
          64,
          9,
          64,
          78,
          52,
          26,
          68,
          111
        ]
      ],
      "MediaCrawler/store/xhs/xhs_store_media.py": [
        [
          "save_image",
          52,
          68,
          64,
          9,
          64,
          96,
          52,
          26,
          68,
          117
        ],
        [
          "save_video",
          99,
          115,
          111,
          9,
          111,
          96,
          99,
          26,
          115,
          117
        ]
      ]
    },
    "aiofiles.open": {
      "MediaCrawler/tools/async_file_writer.py": [
        [
          "write_to_csv",
          22,
          30,
          26,
          24,
          26,
          86,
          22,
          28,
          28,
          34
        ],
        [
          "write_single_item_to_json",
          32,
          50,
          37,
          28,
          37,
          74,
          37,
          28,
          39,
          46
        ],
        [
          "write_single_item_to_json",
          32,
          50,
          49,
          24,
          49,
          70,
          47,
          13,
          50,
          86
        ]
      ],
      "MediaCrawler/store/bilibili/bilibilli_store_media.py": [
        [
          "save_video",
          52,
          68,
          66,
          20,
          66,
          54,
          52,
          26,
          68,
          114
        ]
      ],
      "MediaCrawler/store/douyin/douyin_store_media.py": [
        [
          "save_image",
          48,
          64,
          62,
          20,
          62,
          54,
          48,
          26,
          64,
          112
        ],
        [
          "save_video",
          95,
          111,
          109,
          20,
          109,
          54,
          95,
          26,
          111,
          112
        ]
      ],
      "MediaCrawler/store/weibo/weibo_store_media.py": [
        [
          "save_image",
          52,
          68,
          66,
          20,
          66,
          54,
          52,
          26,
          68,
          111
        ]
      ],
      "MediaCrawler/tools/words.py": [
        [
          "generate_word_frequency_and_cloud",
          41,
          56,
          48,
          20,
          48,
          66,
          41,
          49,
          52,
          29
        ]
      ],
      "MediaCrawler/store/xhs/xhs_store_media.py": [
        [
          "save_image",
          52,
          68,
          66,
          20,
          66,
          54,
          52,
          26,
          68,
          117
        ],
        [
          "save_video",
          99,
          115,
          113,
          20,
          113,
          54,
          99,
          26,
          115,
          117
        ]
      ]
    },
    "os.path.expandvars": {
      "MediaCrawler/tools/browser_launcher.py": [
        [
          "detect_browser_paths",
          35,
          92,
          46,
          17,
          46,
          90,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          47,
          17,
          47,
          95,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          48,
          17,
          48,
          90,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          50,
          17,
          50,
          91,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          51,
          17,
          51,
          96,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          53,
          17,
          53,
          95,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          54,
          17,
          54,
          94,
          46,
          17,
          44,
          26
        ],
        [
          "detect_browser_paths",
          35,
          92,
          55,
          17,
          55,
          94,
          46,
          17,
          44,
          26
        ]
      ]
    },
    "os.path.isfile": {
      "MediaCrawler/tools/browser_launcher.py": [
        [
          "detect_browser_paths",
          35,
          92,
          89,
          16,
          89,
          35,
          88,
          13,
          89,
          35
        ]
      ],
      "MediaCrawler/tools/cdp_browser.py": [
        [
          "_get_browser_path",
          71,
          99,
          76,
          43,
          76,
          84,
          76,
          43,
          76,
          84
        ]
      ]
    },
    "os.access": {
      "MediaCrawler/tools/browser_launcher.py": [
        [
          "detect_browser_paths",
          35,
          92,
          89,
          41,
          89,
          64,
          89,
          41,
          89,
          64
        ]
      ]
    },
    "os.path.join": {
      "MediaCrawler/tools/cdp_browser.py": [
        [
          "_launch_browser",
          124,
          160,
          131,
          29,
          135,
          13,
          131,
          29,
          137,
          77
        ]
      ],
      "MediaCrawler/media_platform/weibo/core.py": [
        [
          "launch_browser",
          322,
          348,
          332,
          29,
          332,
          109,
          332,
          29,
          344,
          34
        ]
      ],
      "MediaCrawler/media_platform/douyin/core.py": [
        [
          "launch_browser",
          266,
          291,
          275,
          29,
          275,
          109,
          275,
          29,
          287,
          34
        ]
      ],
      "MediaCrawler/media_platform/kuaishou/core.py": [
        [
          "launch_browser",
          299,
          328,
          311,
          29,
          313,
          13,
          311,
          29,
          322,
          34
        ]
      ],
      "MediaCrawler/media_platform/tieba/core.py": [
        [
          "launch_browser",
          350,
          391,
          374,
          29,
          376,
          13,
          374,
          29,
          385,
          34
        ]
      ],
      "MediaCrawler/media_platform/bilibili/core.py": [
        [
          "launch_browser",
          450,
          486,
          469,
          29,
          469,
          109,
          469,
          29,
          481,
          34
        ]
      ],
      "MediaCrawler/media_platform/xhs/core.py": [
        [
          "launch_browser",
          361,
          389,
          373,
          29,
          373,
          109,
          373,
          29,
          385,
          34
        ]
      ],
      "MediaCrawler/media_platform/zhihu/core.py": [
        [
          "launch_browser",
          408,
          439,
          422,
          29,
          424,
          13,
          422,
          29,
          433,
          34
        ]
      ],
      "MediaCrawler/tools/slider_util.py": [
        [
          "__init__",
          30,
          43,
          35,
          24,
          35,
          62,
          30,
          18,
          36,
          43
        ],
        [
          "__init__",
          30,
          43,
          43,
          36,
          43,
          72,
          43,
          36,
          43,
          72
        ]
      ]
    },
    "os.makedirs": {
      "MediaCrawler/tools/cdp_browser.py": [
        [
          "_launch_browser",
          124,
          160,
          136,
          13,
          136,
          53,
          131,
          29,
          137,
          77
        ]
      ],
      "MediaCrawler/tools/slider_util.py": [
        [
          "__init__",
          30,
          43,
          37,
          13,
          37,
          37,
          37,
          13,
          37,
          37
        ]
      ]
    },
    "open": {
      "MediaCrawler/media_platform/kuaishou/graphql.py": [
        [
          "load_graphql_queries",
          24,
          30,
          28,
          18,
          28,
          56,
          27,
          13,
          30,
          48
        ]
      ],
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "test_extract_search_note_list",
          359,
          364,
          360,
          10,
          360,
          75,
          360,
          10,
          364,
          21
        ],
        [
          "test_extract_note_detail",
          367,
          372,
          368,
          10,
          368,
          66,
          368,
          10,
          372,
          34
        ],
        [
          "test_extract_tieba_note_parment_comments",
          375,
          380,
          376,
          10,
          376,
          68,
          376,
          10,
          380,
          21
        ],
        [
          "test_extract_tieba_note_sub_comments",
          383,
          393,
          384,
          10,
          384,
          72,
          384,
          10,
          393,
          21
        ],
        [
          "test_extract_tieba_note_list",
          396,
          402,
          397,
          10,
          397,
          70,
          397,
          10,
          402,
          8
        ],
        [
          "test_extract_creator_info",
          405,
          410,
          406,
          10,
          406,
          67,
          406,
          10,
          410,
          39
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "sign",
          28,
          43,
          40,
          14,
          40,
          66,
          40,
          14,
          41,
          25
        ]
      ],
      "MediaCrawler/tools/words.py": [
        [
          "load_stop_words",
          37,
          39,
          38,
          14,
          38,
          62,
          37,
          25,
          39,
          52
        ]
      ]
    }
  },
  "CWE-078": {
    "subprocess.Popen": {
      "MediaCrawler/tools/browser_launcher.py": [
        [
          "launch_browser",
          109,
          177,
          159,
          27,
          164,
          17,
          163,
          21,
          164,
          17
        ],
        [
          "launch_browser",
          109,
          177,
          166,
          27,
          171,
          17,
          170,
          21,
          171,
          17
        ]
      ]
    },
    "subprocess.run": {
      "MediaCrawler/tools/browser_launcher.py": [
        [
          "get_browser_info",
          202,
          227,
          218,
          26,
          219,
          80,
          218,
          42,
          219,
          80
        ],
        [
          "cleanup",
          229,
          249,
          239,
          21,
          240,
          53,
          239,
          36,
          240,
          53
        ]
      ]
    }
  },
  "CWE-079": {
    "html.unescape": {
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_data_field_value",
          337,
          356,
          351,
          34,
          351,
          64,
          351,
          48,
          351,
          64
        ]
      ]
    }
  },
  "CWE-095": {
    "json.loads": {
      "MediaCrawler/tools/async_file_writer.py": [
        [
          "write_single_item_to_json",
          32,
          50,
          41,
          45,
          41,
          63,
          41,
          56,
          41,
          63
        ]
      ],
      "MediaCrawler/proxy/base_proxy.py": [
        [
          "load_all_ip",
          59,
          75,
          72,
          50,
          72,
          69,
          72,
          61,
          72,
          69
        ]
      ],
      "MediaCrawler/media_platform/weibo/client.py": [
        [
          "get_note_info_by_id",
          213,
          233,
          227,
          36,
          227,
          63,
          226,
          36,
          230,
          32
        ]
      ],
      "MediaCrawler/media_platform/xhs/extractor.py": [
        [
          "extract_note_detail_from_html",
          22,
          41,
          39,
          42,
          39,
          58,
          39,
          25,
          40,
          72
        ],
        [
          "extract_creator_info_from_html",
          43,
          60,
          57,
          16,
          57,
          86,
          57,
          16,
          58,
          23
        ]
      ],
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_data_field_value",
          337,
          356,
          352,
          37,
          352,
          66,
          352,
          48,
          352,
          66
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "extract_creator",
          319,
          361,
          336,
          35,
          336,
          58,
          336,
          35,
          338,
          25
        ],
        [
          "extract_answer_content_from_html",
          381,
          398,
          393,
          27,
          393,
          50,
          393,
          27,
          395,
          26
        ],
        [
          "extract_article_content_from_html",
          400,
          417,
          412,
          27,
          412,
          50,
          412,
          27,
          414,
          27
        ],
        [
          "extract_zvideo_content_from_html",
          419,
          445,
          431,
          27,
          431,
          50,
          431,
          27,
          434,
          26
        ]
      ]
    },
    "input": {
      "MediaCrawler/test/test_db_sync.py": [
        [
          "main",
          164,
          197,
          175,
          22,
          175,
          70,
          175,
          22,
          175,
          70
        ],
        [
          "main",
          164,
          197,
          190,
          22,
          190,
          71,
          190,
          22,
          190,
          71
        ]
      ]
    }
  },
  "CWE-113": {
    "urllib.parse.urlparse": {
      "MediaCrawler/tools/crawler_util.py": [
        [
          "extract_url_params_to_dict",
          205,
          212,
          210,
          18,
          210,
          43,
          210,
          18,
          212,
          26
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "extract_offset",
          282,
          299,
          296,
          22,
          296,
          39,
          296,
          22,
          299,
          21
        ]
      ],
      "MediaCrawler/tools/slider_util.py": [
        [
          "check_is_img_path",
          46,
          72,
          55,
          25,
          55,
          37,
          49,
          17,
          61,
          41
        ]
      ]
    }
  },
  "CWE-117": {
    "re.sub": {
      "MediaCrawler/store/weibo/__init__.py": [
        [
          "update_weibo_note",
          56,
          95,
          72,
          18,
          72,
          51,
          68,
          19,
          95,
          88
        ],
        [
          "update_weibo_note_comment",
          114,
          150,
          129,
          18,
          129,
          51,
          126,
          18,
          150,
          88
        ]
      ],
      "MediaCrawler/tools/crawler_util.py": [
        [
          "extract_text_from_html",
          194,
          203,
          200,
          18,
          200,
          84,
          200,
          18,
          203,
          21
        ],
        [
          "extract_text_from_html",
          194,
          203,
          202,
          18,
          202,
          51,
          200,
          18,
          203,
          21
        ]
      ]
    },
    "json.dumps": {
      "MediaCrawler/store/xhs/__init__.py": [
        [
          "save_creator",
          164,
          210,
          205,
          21,
          206,
          84,
          187,
          5,
          210,
          69
        ]
      ],
      "MediaCrawler/store/xhs/_store_impl.py": [
        [
          "add_content",
          98,
          125,
          119,
          24,
          119,
          65,
          98,
          27,
          125,
          25
        ],
        [
          "add_content",
          98,
          125,
          120,
          22,
          120,
          61,
          98,
          27,
          125,
          25
        ],
        [
          "add_comment",
          158,
          177,
          173,
          22,
          173,
          61,
          158,
          27,
          177,
          28
        ],
        [
          "add_creator",
          205,
          222,
          220,
          22,
          220,
          61,
          205,
          27,
          222,
          28
        ],
        [
          "update_creator",
          224,
          238,
          235,
          25,
          235,
          64,
          224,
          30,
          238,
          35
        ]
      ],
      "MediaCrawler/tools/async_file_writer.py": [
        [
          "write_single_item_to_json",
          32,
          50,
          50,
          31,
          50,
          85,
          47,
          13,
          50,
          86
        ]
      ],
      "MediaCrawler/media_platform/weibo/client.py": [
        [
          "post",
          82,
          84,
          83,
          20,
          83,
          78,
          82,
          20,
          84,
          111
        ]
      ],
      "MediaCrawler/media_platform/kuaishou/client.py": [
        [
          "post",
          64,
          68,
          65,
          20,
          65,
          78,
          64,
          20,
          68,
          9
        ]
      ],
      "MediaCrawler/media_platform/douyin/client.py": [
        [
          "search_info_by_keyword",
          134,
          174,
          168,
          47,
          168,
          134,
          168,
          47,
          170,
          41
        ]
      ],
      "MediaCrawler/media_platform/xhs/client.py": [
        [
          "post",
          139,
          157,
          150,
          20,
          150,
          78,
          139,
          20,
          157,
          9
        ]
      ],
      "MediaCrawler/media_platform/tieba/client.py": [
        [
          "post",
          109,
          120,
          119,
          20,
          119,
          78,
          109,
          20,
          120,
          99
        ]
      ],
      "MediaCrawler/media_platform/bilibili/client.py": [
        [
          "post",
          108,
          111,
          110,
          20,
          110,
          78,
          108,
          20,
          111,
          111
        ]
      ],
      "MediaCrawler/media_platform/xhs/help.py": [
        [
          "sign",
          22,
          49,
          41,
          29,
          41,
          69,
          22,
          10,
          49,
          5
        ]
      ],
      "MediaCrawler/tools/words.py": [
        [
          "generate_word_frequency_and_cloud",
          41,
          56,
          49,
          30,
          49,
          80,
          41,
          49,
          52,
          29
        ]
      ]
    },
    "print": {
      "MediaCrawler/tools/crawler_util.py": [
        [
          "find_login_qrcode",
          33,
          53,
          52,
          9,
          52,
          16,
          51,
          5,
          53,
          17
        ]
      ],
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_data_field_value",
          337,
          356,
          354,
          13,
          354,
          68,
          353,
          9,
          355,
          33
        ],
        [
          "test_extract_search_note_list",
          359,
          364,
          364,
          9,
          364,
          21,
          360,
          10,
          364,
          21
        ],
        [
          "test_extract_note_detail",
          367,
          372,
          372,
          9,
          372,
          34,
          368,
          10,
          372,
          34
        ],
        [
          "test_extract_tieba_note_parment_comments",
          375,
          380,
          380,
          9,
          380,
          21,
          376,
          10,
          380,
          21
        ],
        [
          "test_extract_tieba_note_sub_comments",
          383,
          393,
          393,
          9,
          393,
          21,
          384,
          10,
          393,
          21
        ],
        [
          "test_extract_tieba_note_list",
          396,
          402,
          401,
          9,
          401,
          21,
          397,
          10,
          402,
          8
        ],
        [
          "test_extract_creator_info",
          405,
          410,
          410,
          9,
          410,
          39,
          406,
          10,
          410,
          39
        ]
      ],
      "MediaCrawler/main.py": [
        [
          "main",
          57,
          73,
          67,
          9,
          67,
          67,
          66,
          15,
          68,
          14
        ]
      ],
      "MediaCrawler/test/test_proxy_ip_pool.py": [
        [
          "test_ip_pool",
          23,
          29,
          25,
          9,
          25,
          19,
          23,
          28,
          26,
          25
        ],
        [
          "test_ip_pool",
          23,
          29,
          28,
          13,
          28,
          32,
          26,
          13,
          29,
          70
        ]
      ],
      "MediaCrawler/test/test_db_sync.py": [
        [
          "print_diff",
          84,
          113,
          86,
          5,
          86,
          41,
          84,
          16,
          87,
          29
        ],
        [
          "print_diff",
          84,
          113,
          88,
          9,
          88,
          36,
          88,
          9,
          89,
          14
        ],
        [
          "print_diff",
          84,
          113,
          92,
          9,
          92,
          28,
          92,
          9,
          93,
          41
        ],
        [
          "print_diff",
          84,
          113,
          94,
          13,
          94,
          33,
          93,
          13,
          94,
          33
        ],
        [
          "print_diff",
          84,
          113,
          97,
          9,
          97,
          28,
          97,
          9,
          98,
          43
        ],
        [
          "print_diff",
          84,
          113,
          99,
          13,
          99,
          33,
          98,
          13,
          99,
          33
        ],
        [
          "print_diff",
          84,
          113,
          102,
          9,
          102,
          28,
          102,
          9,
          103,
          60
        ],
        [
          "print_diff",
          84,
          113,
          104,
          13,
          104,
          34,
          103,
          13,
          105,
          35
        ],
        [
          "print_diff",
          84,
          113,
          106,
          17,
          106,
          67,
          106,
          17,
          106,
          67
        ],
        [
          "print_diff",
          84,
          113,
          108,
          17,
          108,
          69,
          108,
          17,
          108,
          69
        ],
        [
          "print_diff",
          84,
          113,
          110,
          17,
          110,
          38,
          110,
          17,
          111,
          61
        ],
        [
          "print_diff",
          84,
          113,
          112,
          21,
          112,
          69,
          111,
          21,
          112,
          69
        ],
        [
          "print_diff",
          84,
          113,
          113,
          5,
          113,
          25,
          113,
          5,
          113,
          25
        ],
        [
          "sync_database",
          116,
          161,
          131,
          9,
          131,
          36,
          129,
          9,
          131,
          36
        ],
        [
          "sync_database",
          116,
          161,
          138,
          13,
          138,
          40,
          137,
          13,
          138,
          40
        ],
        [
          "sync_database",
          116,
          161,
          145,
          13,
          145,
          56,
          143,
          13,
          145,
          56
        ],
        [
          "sync_database",
          116,
          161,
          152,
          17,
          152,
          60,
          151,
          17,
          152,
          60
        ],
        [
          "sync_database",
          116,
          161,
          161,
          21,
          161,
          85,
          160,
          21,
          161,
          85
        ],
        [
          "main",
          164,
          197,
          178,
          17,
          178,
          38,
          178,
          17,
          178,
          38
        ],
        [
          "main",
          164,
          197,
          180,
          9,
          180,
          33,
          179,
          5,
          180,
          33
        ],
        [
          "main",
          164,
          197,
          193,
          17,
          193,
          61,
          193,
          17,
          193,
          61
        ],
        [
          "main",
          164,
          197,
          195,
          17,
          195,
          39,
          195,
          17,
          195,
          39
        ],
        [
          "main",
          164,
          197,
          197,
          9,
          197,
          34,
          196,
          5,
          197,
          34
        ]
      ]
    },
    "str.replace": {
      "MediaCrawler/cache/local_cache.py": [
        [
          "keys",
          74,
          87,
          85,
          23,
          85,
          46,
          85,
          23,
          85,
          19
        ]
      ],
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_tieba_note_list",
          63,
          96,
          72,
          24,
          72,
          55,
          63,
          33,
          77,
          38
        ]
      ]
    },
    "logging.getLogger": {
      "MediaCrawler/tools/words.py": [
        [
          "__init__",
          28,
          35,
          29,
          9,
          29,
          34,
          28,
          18,
          34,
          52
        ]
      ],
      "MediaCrawler/tools/utils.py": [
        [
          "init_loging_config",
          20,
          29,
          27,
          15,
          27,
          47,
          21,
          13,
          29,
          18
        ]
      ]
    },
    "logging.basicConfig": {
      "MediaCrawler/tools/utils.py": [
        [
          "init_loging_config",
          20,
          29,
          22,
          5,
          26,
          5,
          21,
          13,
          29,
          18
        ]
      ]
    }
  },
  "CWE-326": {},
  "CWE-327": {
    "hashlib.md5": {
      "MediaCrawler/media_platform/bilibili/help.py": [
        [
          "sign",
          46,
          66,
          64,
          20,
          64,
          47,
          46,
          14,
          66,
          23
        ]
      ]
    }
  },
  "CWE-329": {
    "random.random": {
      "MediaCrawler/media_platform/douyin/core.py": [
        [
          "get_aweme_images",
          357,
          382,
          377,
          33,
          377,
          47,
          376,
          29,
          378,
          30
        ],
        [
          "get_aweme_video",
          384,
          405,
          401,
          29,
          401,
          43,
          400,
          25,
          402,
          26
        ]
      ],
      "MediaCrawler/media_platform/xhs/core.py": [
        [
          "get_note_images",
          439,
          467,
          462,
          33,
          462,
          47,
          461,
          29,
          463,
          30
        ],
        [
          "get_notice_video",
          469,
          491,
          486,
          33,
          486,
          47,
          484,
          13,
          487,
          30
        ]
      ],
      "MediaCrawler/media_platform/douyin/help.py": [
        [
          "e",
          32,
          38,
          34,
          38,
          34,
          52,
          34,
          20,
          34,
          67
        ]
      ]
    },
    "random.randint": {
      "MediaCrawler/media_platform/xhs/help.py": [
        [
          "get_b3_trace_id",
          52,
          58,
          57,
          17,
          57,
          41,
          56,
          9,
          57,
          9
        ]
      ]
    }
  },
  "CWE-347": {},
  "CWE-377": {
    "open": {
      "MediaCrawler/media_platform/kuaishou/graphql.py": [
        [
          "load_graphql_queries",
          24,
          30,
          28,
          18,
          28,
          56,
          27,
          13,
          30,
          48
        ]
      ],
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "test_extract_search_note_list",
          359,
          364,
          360,
          10,
          360,
          75,
          360,
          10,
          364,
          21
        ],
        [
          "test_extract_note_detail",
          367,
          372,
          368,
          10,
          368,
          66,
          368,
          10,
          372,
          34
        ],
        [
          "test_extract_tieba_note_parment_comments",
          375,
          380,
          376,
          10,
          376,
          68,
          376,
          10,
          380,
          21
        ],
        [
          "test_extract_tieba_note_sub_comments",
          383,
          393,
          384,
          10,
          384,
          72,
          384,
          10,
          393,
          21
        ],
        [
          "test_extract_tieba_note_list",
          396,
          402,
          397,
          10,
          397,
          70,
          397,
          10,
          402,
          8
        ],
        [
          "test_extract_creator_info",
          405,
          410,
          406,
          10,
          406,
          67,
          406,
          10,
          410,
          39
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "sign",
          28,
          43,
          40,
          14,
          40,
          66,
          40,
          14,
          41,
          25
        ]
      ],
      "MediaCrawler/tools/words.py": [
        [
          "load_stop_words",
          37,
          39,
          38,
          14,
          38,
          62,
          37,
          25,
          39,
          52
        ]
      ]
    }
  },
  "CWE-502": {
    "json.loads": {
      "MediaCrawler/tools/async_file_writer.py": [
        [
          "write_single_item_to_json",
          32,
          50,
          41,
          45,
          41,
          63,
          41,
          56,
          41,
          63
        ]
      ],
      "MediaCrawler/proxy/base_proxy.py": [
        [
          "load_all_ip",
          59,
          75,
          72,
          50,
          72,
          69,
          72,
          61,
          72,
          69
        ]
      ],
      "MediaCrawler/media_platform/weibo/client.py": [
        [
          "get_note_info_by_id",
          213,
          233,
          227,
          36,
          227,
          63,
          226,
          36,
          230,
          32
        ]
      ],
      "MediaCrawler/media_platform/xhs/extractor.py": [
        [
          "extract_note_detail_from_html",
          22,
          41,
          39,
          42,
          39,
          58,
          39,
          25,
          40,
          72
        ],
        [
          "extract_creator_info_from_html",
          43,
          60,
          57,
          16,
          57,
          86,
          57,
          16,
          58,
          23
        ]
      ],
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_data_field_value",
          337,
          356,
          352,
          37,
          352,
          66,
          352,
          48,
          352,
          66
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "extract_creator",
          319,
          361,
          336,
          35,
          336,
          58,
          336,
          35,
          338,
          25
        ],
        [
          "extract_answer_content_from_html",
          381,
          398,
          393,
          27,
          393,
          50,
          393,
          27,
          395,
          26
        ],
        [
          "extract_article_content_from_html",
          400,
          417,
          412,
          27,
          412,
          50,
          412,
          27,
          414,
          27
        ],
        [
          "extract_zvideo_content_from_html",
          419,
          445,
          431,
          27,
          431,
          50,
          431,
          27,
          434,
          26
        ]
      ]
    },
    "PIL.Image.open": {
      "MediaCrawler/tools/crawler_util.py": [
        [
          "show_qrcode",
          78,
          92,
          83,
          13,
          83,
          40,
          82,
          15,
          92,
          20
        ]
      ]
    },
    "pickle.loads": {
      "MediaCrawler/cache/redis_cache.py": [
        [
          "get",
          46,
          55,
          55,
          16,
          55,
          34,
          55,
          16,
          55,
          34
        ]
      ]
    },
    "cv2.imread": {
      "MediaCrawler/tools/slider_util.py": [
        [
          "clear_white",
          75,
          97,
          77,
          15,
          77,
          29,
          75,
          21,
          83,
          31
        ],
        [
          "discern",
          121,
          133,
          126,
          16,
          126,
          54,
          121,
          17,
          133,
          16
        ]
      ]
    }
  },
  "CWE-643": {
    "parsel.Selector.xpath": {
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_search_note_list",
          34,
          61,
          44,
          21,
          44,
          69,
          34,
          34,
          46,
          29
        ],
        [
          "extract_tieba_note_list",
          63,
          96,
          75,
          21,
          75,
          58,
          63,
          33,
          77,
          38
        ],
        [
          "extract_tieba_note_list",
          63,
          96,
          91,
          47,
          91,
          109,
          89,
          36,
          95,
          37
        ],
        [
          "extract_tieba_note_list",
          63,
          96,
          92,
          90,
          93,
          59,
          89,
          36,
          95,
          37
        ],
        [
          "extract_note_detail",
          98,
          133,
          108,
          32,
          108,
          86,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          109,
          33,
          109,
          86,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          112,
          28,
          113,
          88,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          115,
          30,
          115,
          86,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          117,
          49,
          117,
          88,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          118,
          31,
          118,
          92,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          126,
          37,
          126,
          99,
          98,
          29,
          133,
          19
        ],
        [
          "extract_note_detail",
          98,
          133,
          127,
          80,
          128,
          55,
          98,
          29,
          133,
          19
        ],
        [
          "extract_tieba_note_parment_comments",
          135,
          170,
          146,
          24,
          146,
          72,
          135,
          45,
          148,
          44
        ],
        [
          "extract_tieba_note_sub_comments",
          172,
          205,
          184,
          28,
          184,
          101,
          172,
          41,
          186,
          43
        ],
        [
          "extract_tieba_note_sub_comments",
          172,
          205,
          185,
          33,
          185,
          91,
          172,
          41,
          186,
          43
        ],
        [
          "extract_creator_info",
          207,
          238,
          217,
          30,
          217,
          68,
          207,
          30,
          220,
          79
        ],
        [
          "extract_creator_info",
          207,
          238,
          222,
          38,
          222,
          88,
          221,
          19,
          225,
          41
        ],
        [
          "extract_creator_info",
          207,
          238,
          223,
          32,
          223,
          77,
          221,
          19,
          225,
          41
        ],
        [
          "extract_creator_info",
          207,
          238,
          229,
          38,
          229,
          98,
          227,
          24,
          238,
          29
        ],
        [
          "extract_creator_info",
          207,
          238,
          231,
          36,
          231,
          98,
          227,
          24,
          238,
          29
        ],
        [
          "extract_tieba_thread_id_list_from_creator_page",
          241,
          261,
          257,
          27,
          257,
          56,
          242,
          9,
          258,
          41
        ],
        [
          "extract_data_field_value",
          337,
          356,
          346,
          28,
          346,
          58,
          337,
          34,
          347,
          31
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "extract_creator",
          319,
          361,
          332,
          24,
          332,
          97,
          332,
          24,
          333,
          27
        ],
        [
          "extract_answer_content_from_html",
          381,
          398,
          390,
          29,
          390,
          102,
          381,
          42,
          391,
          27
        ],
        [
          "extract_article_content_from_html",
          400,
          417,
          409,
          29,
          409,
          102,
          400,
          43,
          410,
          27
        ],
        [
          "extract_zvideo_content_from_html",
          419,
          445,
          428,
          29,
          428,
          102,
          419,
          42,
          429,
          27
        ]
      ]
    }
  },
  "CWE-760": {
    "hashlib.md5": {
      "MediaCrawler/media_platform/bilibili/help.py": [
        [
          "sign",
          46,
          66,
          64,
          20,
          64,
          47,
          46,
          14,
          66,
          23
        ]
      ]
    }
  },
  "CWE-918": {
    "httpx.AsyncClient": {
      "MediaCrawler/media_platform/weibo/client.py": [
        [
          "request",
          53,
          70,
          55,
          20,
          55,
          54,
          53,
          23,
          58,
          33
        ],
        [
          "get_note_info_by_id",
          213,
          233,
          220,
          20,
          220,
          54,
          213,
          35,
          222,
          42
        ],
        [
          "get_note_image",
          235,
          261,
          250,
          20,
          250,
          54,
          248,
          22,
          252,
          47
        ]
      ],
      "MediaCrawler/media_platform/zhihu/client.py": [
        [
          "request",
          68,
          104,
          82,
          20,
          82,
          54,
          68,
          23,
          85,
          38
        ]
      ],
      "MediaCrawler/tools/cdp_browser.py": [
        [
          "_get_browser_websocket_url",
          162,
          185,
          167,
          24,
          167,
          42,
          167,
          24,
          167,
          42
        ]
      ],
      "MediaCrawler/media_platform/kuaishou/client.py": [
        [
          "request",
          47,
          54,
          48,
          20,
          48,
          54,
          47,
          23,
          51,
          29
        ]
      ],
      "MediaCrawler/media_platform/xhs/client.py": [
        [
          "request",
          87,
          119,
          100,
          20,
          100,
          54,
          87,
          23,
          103,
          38
        ],
        [
          "get_note_media",
          159,
          177,
          160,
          20,
          160,
          54,
          159,
          30,
          162,
          47
        ]
      ],
      "MediaCrawler/media_platform/douyin/client.py": [
        [
          "request",
          97,
          106,
          98,
          20,
          98,
          54,
          97,
          23,
          101,
          28
        ],
        [
          "get_aweme_media",
          314,
          326,
          315,
          20,
          315,
          54,
          314,
          31,
          317,
          47
        ]
      ],
      "MediaCrawler/media_platform/tieba/client.py": [
        [
          "request",
          49,
          78,
          63,
          20,
          63,
          56,
          62,
          24,
          66,
          38
        ]
      ],
      "MediaCrawler/media_platform/bilibili/client.py": [
        [
          "request",
          51,
          62,
          52,
          20,
          52,
          54,
          51,
          23,
          55,
          38
        ],
        [
          "get_video_media",
          203,
          215,
          204,
          20,
          204,
          54,
          203,
          31,
          206,
          47
        ]
      ],
      "MediaCrawler/tools/crawler_util.py": [
        [
          "find_login_qrcode",
          33,
          53,
          41,
          24,
          41,
          63,
          41,
          59,
          41,
          63
        ]
      ],
      "MediaCrawler/proxy/providers/jishu_http_proxy.py": [
        [
          "get_proxy",
          47,
          86,
          62,
          20,
          62,
          38,
          59,
          26,
          69,
          40
        ]
      ],
      "MediaCrawler/proxy/providers/kuaidl_proxy.py": [
        [
          "get_proxy",
          83,
          131,
          104,
          20,
          104,
          38,
          100,
          26,
          107,
          42
        ]
      ],
      "MediaCrawler/proxy/proxy_ip_pool.py": [
        [
          "_is_valid_proxy",
          58,
          84,
          74,
          24,
          74,
          57,
          74,
          48,
          74,
          57
        ]
      ],
      "MediaCrawler/proxy/providers/wandou_http_proxy.py": [
        [
          "get_proxy",
          42,
          97,
          59,
          20,
          59,
          38,
          56,
          26,
          69,
          42
        ]
      ]
    },
    "httpx.AsyncClient.request": {
      "MediaCrawler/media_platform/weibo/client.py": [
        [
          "request",
          53,
          70,
          56,
          30,
          56,
          88,
          53,
          23,
          58,
          33
        ],
        [
          "get_note_info_by_id",
          213,
          233,
          221,
          30,
          221,
          99,
          213,
          35,
          222,
          42
        ],
        [
          "get_note_image",
          235,
          261,
          252,
          34,
          252,
          87,
          252,
          67,
          252,
          87
        ]
      ],
      "MediaCrawler/media_platform/zhihu/client.py": [
        [
          "request",
          68,
          104,
          83,
          30,
          83,
          88,
          68,
          23,
          85,
          38
        ]
      ],
      "MediaCrawler/media_platform/kuaishou/client.py": [
        [
          "request",
          47,
          54,
          49,
          30,
          49,
          88,
          47,
          23,
          51,
          29
        ]
      ],
      "MediaCrawler/media_platform/xhs/client.py": [
        [
          "request",
          87,
          119,
          101,
          30,
          101,
          88,
          87,
          23,
          103,
          38
        ],
        [
          "get_note_media",
          159,
          177,
          162,
          34,
          162,
          81,
          162,
          61,
          162,
          81
        ]
      ],
      "MediaCrawler/media_platform/douyin/client.py": [
        [
          "request",
          97,
          106,
          99,
          30,
          99,
          88,
          97,
          23,
          101,
          28
        ],
        [
          "get_aweme_media",
          314,
          326,
          317,
          34,
          317,
          104,
          317,
          61,
          317,
          104
        ]
      ],
      "MediaCrawler/media_platform/tieba/client.py": [
        [
          "request",
          49,
          78,
          64,
          30,
          64,
          110,
          62,
          24,
          66,
          38
        ]
      ],
      "MediaCrawler/media_platform/bilibili/client.py": [
        [
          "request",
          51,
          62,
          53,
          30,
          53,
          88,
          51,
          23,
          55,
          38
        ],
        [
          "get_video_media",
          203,
          215,
          206,
          34,
          206,
          103,
          206,
          83,
          206,
          103
        ]
      ]
    },
    "urllib.parse.urlparse": {
      "MediaCrawler/tools/crawler_util.py": [
        [
          "extract_url_params_to_dict",
          205,
          212,
          210,
          18,
          210,
          43,
          210,
          18,
          212,
          26
        ]
      ],
      "MediaCrawler/media_platform/zhihu/help.py": [
        [
          "extract_offset",
          282,
          299,
          296,
          22,
          296,
          39,
          296,
          22,
          299,
          21
        ]
      ],
      "MediaCrawler/tools/slider_util.py": [
        [
          "check_is_img_path",
          46,
          72,
          55,
          25,
          55,
          37,
          49,
          17,
          61,
          41
        ]
      ]
    },
    "httpx.get": {
      "MediaCrawler/tools/slider_util.py": [
        [
          "check_is_img_path",
          46,
          72,
          60,
          23,
          60,
          53,
          49,
          17,
          61,
          41
        ]
      ]
    }
  },
  "CWE-943": {
    "sqlalchemy.text": {
      "MediaCrawler/database/db_session.py": [
        [
          "create_database_if_not_exists",
          13,
          20,
          19,
          32,
          19,
          98,
          16,
          22,
          20,
          30
        ]
      ]
    }
  },
  "CWE-1333": {
    "re.sub": {
      "MediaCrawler/store/weibo/__init__.py": [
        [
          "update_weibo_note",
          56,
          95,
          72,
          18,
          72,
          51,
          68,
          19,
          95,
          88
        ],
        [
          "update_weibo_note_comment",
          114,
          150,
          129,
          18,
          129,
          51,
          126,
          18,
          150,
          88
        ]
      ],
      "MediaCrawler/tools/crawler_util.py": [
        [
          "extract_text_from_html",
          194,
          203,
          200,
          18,
          200,
          84,
          200,
          18,
          203,
          21
        ],
        [
          "extract_text_from_html",
          194,
          203,
          202,
          18,
          202,
          51,
          200,
          18,
          203,
          21
        ]
      ]
    },
    "re.search": {
      "MediaCrawler/media_platform/weibo/client.py": [
        [
          "get_note_info_by_id",
          213,
          233,
          224,
          21,
          224,
          94,
          224,
          21,
          225,
          20
        ]
      ],
      "MediaCrawler/tools/crawler_util.py": [
        [
          "match_interact_info_count",
          163,
          172,
          167,
          13,
          167,
          40,
          167,
          13,
          168,
          12
        ]
      ],
      "MediaCrawler/media_platform/xhs/extractor.py": [
        [
          "extract_creator_info_from_html",
          43,
          60,
          52,
          17,
          54,
          9,
          43,
          40,
          55,
          24
        ]
      ],
      "MediaCrawler/proxy/providers/kuaidl_proxy.py": [
        [
          "parse_kuaidaili_proxy",
          34,
          56,
          48,
          13,
          48,
          42,
          47,
          15,
          49,
          25
        ]
      ]
    },
    "re.findall": {
      "MediaCrawler/media_platform/xhs/extractor.py": [
        [
          "extract_note_detail_from_html",
          22,
          41,
          35,
          17,
          35,
          77,
          35,
          17,
          38,
          24
        ]
      ]
    },
    "re.compile": {
      "MediaCrawler/media_platform/tieba/help.py": [
        [
          "extract_ip_and_pub_time",
          263,
          275,
          272,
          28,
          272,
          104,
          263,
          33,
          274,
          52
        ],
        [
          "extract_ip",
          278,
          290,
          287,
          22,
          287,
          53,
          278,
          20,
          289,
          42
        ],
        [
          "extract_follow_and_fans",
          309,
          323,
          318,
          19,
          318,
          87,
          309,
          33,
          321,
          49
        ],
        [
          "extract_registration_duration",
          326,
          334,
          332,
          19,
          332,
          54,
          326,
          39,
          334,
          38
        ]
      ],
      "MediaCrawler/recv_sms.py": [
        [
          "extract_verification_code",
          37,
          43,
          41,
          15,
          41,
          41,
          37,
          31,
          43,
          28
        ]
      ]
    },
    "str.startswith": {
      "MediaCrawler/tools/slider_util.py": [
        [
          "check_is_img_path",
          46,
          72,
          47,
          12,
          47,
          33,
          46,
          27,
          47,
          33
        ]
      ]
    }
  }
}