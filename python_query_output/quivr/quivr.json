{
  "CWE-022": {
    "open": {
      "quivr/core/quivr_core/base_config.py": [
        [
          "from_yaml",
          27,
          42,
          38,
          14,
          38,
          33,
          27,
          19,
          42,
          33
        ]
      ],
      "quivr/core/quivr_core/config.py": [
        [
          "from_yaml",
          25,
          31,
          27,
          14,
          27,
          33,
          25,
          19,
          31,
          33
        ]
      ],
      "quivr/examples/quivr-whisper/app.py": [
        [
          "transcribe_audio_file",
          117,
          131,
          123,
          14,
          123,
          45,
          117,
          27,
          123,
          45
        ]
      ],
      "quivr/core/tests/conftest.py": [
        [
          "chunks_stream_answer",
          55,
          65,
          56,
          10,
          56,
          56,
          56,
          10,
          60,
          24
        ]
      ],
      "quivr/core/tests/fixture_chunks.py": [
        [
          "main",
          14,
          49,
          27,
          10,
          27,
          36,
          15,
          24,
          38,
          9
        ]
      ],
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "load",
          148,
          206,
          167,
          14,
          167,
          64,
          167,
          14,
          172,
          75
        ],
        [
          "save",
          208,
          272,
          270,
          14,
          270,
          63,
          260,
          23,
          272,
          25
        ]
      ],
      "quivr/examples/chatbot/main.py": [
        [
          "on_chat_start",
          9,
          45,
          26,
          10,
          26,
          47,
          21,
          12,
          45,
          39
        ]
      ],
      "quivr/examples/chatbot_voice/main.py": [
        [
          "on_chat_start",
          13,
          49,
          30,
          10,
          30,
          47,
          25,
          12,
          49,
          39
        ]
      ]
    },
    "werkzeug.utils.secure_filename": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          64,
          16,
          64,
          45,
          61,
          8,
          77,
          55
        ]
      ]
    },
    "os.path.join": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          65,
          16,
          65,
          66,
          61,
          8,
          77,
          55
        ]
      ],
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "load",
          148,
          206,
          167,
          19,
          167,
          58,
          167,
          14,
          172,
          75
        ],
        [
          "save",
          208,
          272,
          223,
          22,
          223,
          66,
          223,
          22,
          228,
          44
        ],
        [
          "save",
          208,
          272,
          229,
          29,
          229,
          68,
          229,
          29,
          236,
          54
        ],
        [
          "save",
          208,
          272,
          270,
          19,
          270,
          57,
          260,
          23,
          272,
          25
        ]
      ],
      "quivr/core/quivr_core/storage/local_storage.py": [
        [
          "upload_file",
          59,
          88,
          74,
          20,
          76,
          9,
          59,
          27,
          78,
          40
        ]
      ]
    },
    "tempfile.NamedTemporaryFile": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "transcribe_audio_file",
          117,
          131,
          118,
          10,
          118,
          57,
          117,
          27,
          123,
          45
        ]
      ],
      "quivr/examples/chatbot/main.py": [
        [
          "on_chat_start",
          9,
          45,
          29,
          10,
          31,
          5,
          21,
          12,
          45,
          39
        ]
      ],
      "quivr/examples/chatbot_voice/main.py": [
        [
          "on_chat_start",
          13,
          49,
          33,
          10,
          35,
          5,
          25,
          12,
          49,
          39
        ]
      ],
      "quivr/examples/save_load_brain.py": [
        [
          "main",
          7,
          17,
          8,
          10,
          8,
          61,
          8,
          10,
          17,
          33
        ]
      ],
      "quivr/examples/simple_question/simple_question_streaming.py": [
        [
          "main",
          10,
          29,
          14,
          10,
          14,
          61,
          11,
          19,
          23,
          81
        ]
      ]
    },
    "os.unlink": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "transcribe_audio_file",
          117,
          131,
          129,
          9,
          129,
          39,
          127,
          9,
          131,
          21
        ],
        [
          "transcribe_audio_file",
          117,
          131,
          129,
          9,
          129,
          39,
          129,
          9,
          129,
          39
        ]
      ]
    },
    "pathlib.Path.exists": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          40,
          12,
          40,
          24,
          40,
          12,
          40,
          24
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          73,
          12,
          73,
          24,
          73,
          12,
          73,
          24
        ]
      ],
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "load",
          148,
          206,
          163,
          16,
          163,
          35,
          163,
          16,
          163,
          35
        ]
      ]
    },
    "os.stat": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          43,
          17,
          43,
          29,
          43,
          17,
          50,
          17
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          76,
          17,
          76,
          29,
          76,
          17,
          83,
          17
        ]
      ]
    },
    "aiofiles.open": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          45,
          16,
          45,
          45,
          43,
          17,
          50,
          17
        ],
        [
          "open",
          95,
          101,
          97,
          19,
          97,
          53,
          95,
          20,
          99,
          19
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          78,
          16,
          78,
          45,
          76,
          17,
          83,
          17
        ],
        [
          "open",
          134,
          140,
          136,
          19,
          136,
          53,
          134,
          20,
          138,
          19
        ]
      ],
      "quivr/core/quivr_core/processor/implementations/simple_txt_processor.py": [
        [
          "process_file_inner",
          50,
          62,
          51,
          20,
          51,
          53,
          50,
          34,
          62,
          9
        ]
      ]
    },
    "os.makedirs": {
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "save",
          208,
          272,
          224,
          9,
          224,
          46,
          223,
          22,
          228,
          44
        ],
        [
          "save",
          208,
          272,
          230,
          13,
          230,
          53,
          229,
          29,
          236,
          54
        ]
      ],
      "quivr/core/quivr_core/storage/local_storage.py": [
        [
          "__init__",
          36,
          47,
          47,
          9,
          47,
          49,
          47,
          9,
          47,
          49
        ]
      ]
    },
    "shutil.copy2": {
      "quivr/core/quivr_core/storage/local_storage.py": [
        [
          "upload_file",
          59,
          88,
          82,
          13,
          82,
          45,
          82,
          13,
          82,
          45
        ]
      ]
    },
    "os.symlink": {
      "quivr/core/quivr_core/storage/local_storage.py": [
        [
          "upload_file",
          59,
          88,
          84,
          13,
          84,
          43,
          84,
          13,
          84,
          43
        ]
      ]
    }
  },
  "CWE-078": {},
  "CWE-079": {
    "flask.render_template": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "index",
          33,
          34,
          34,
          12,
          34,
          40,
          34,
          12,
          34,
          40
        ]
      ]
    }
  },
  "CWE-095": {
    "yaml.safe_load": {
      "quivr/core/quivr_core/base_config.py": [
        [
          "from_yaml",
          27,
          42,
          39,
          27,
          39,
          48,
          27,
          19,
          42,
          33
        ]
      ],
      "quivr/core/quivr_core/config.py": [
        [
          "from_yaml",
          25,
          31,
          28,
          27,
          28,
          48,
          25,
          19,
          31,
          33
        ]
      ]
    },
    "json.loads": {
      "quivr/core/tests/conftest.py": [
        [
          "chunks_stream_answer",
          55,
          65,
          61,
          31,
          61,
          44,
          60,
          9,
          62,
          28
        ]
      ]
    }
  },
  "CWE-113": {
    "werkzeug.utils.secure_filename": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          64,
          16,
          64,
          45,
          61,
          8,
          77,
          55
        ]
      ]
    },
    "mimetypes.guess_type": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "get_file_extension",
          20,
          33,
          22,
          24,
          22,
          59,
          22,
          24,
          22,
          59
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "get_file_extension",
          53,
          66,
          55,
          24,
          55,
          59,
          55,
          24,
          55,
          59
        ]
      ]
    },
    "urllib.parse.urlparse": {
      "quivr/core/quivr_core/llm/llm_endpoint.py": [
        [
          "from_config",
          212,
          313,
          228,
          30,
          228,
          58,
          228,
          30,
          228,
          58
        ]
      ]
    }
  },
  "CWE-117": {
    "print": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          68,
          5,
          68,
          52,
          61,
          8,
          77,
          55
        ],
        [
          "upload_file",
          53,
          83,
          70,
          5,
          70,
          39,
          61,
          8,
          77,
          55
        ],
        [
          "upload_file",
          53,
          83,
          81,
          5,
          81,
          85,
          77,
          18,
          83,
          61
        ],
        [
          "ask",
          87,
          114,
          100,
          5,
          100,
          46,
          100,
          5,
          114,
          50
        ],
        [
          "ask",
          87,
          114,
          102,
          5,
          102,
          30,
          100,
          5,
          114,
          50
        ],
        [
          "ask",
          87,
          114,
          105,
          5,
          105,
          44,
          100,
          5,
          114,
          50
        ],
        [
          "ask",
          87,
          114,
          107,
          5,
          107,
          32,
          100,
          5,
          114,
          50
        ],
        [
          "ask",
          87,
          114,
          110,
          5,
          110,
          30,
          100,
          5,
          114,
          50
        ],
        [
          "ask",
          87,
          114,
          113,
          5,
          113,
          17,
          100,
          5,
          114,
          50
        ]
      ],
      "quivr/examples/chatbot/main.py": [
        [
          "main",
          49,
          83,
          73,
          17,
          73,
          29,
          71,
          17,
          74,
          129
        ]
      ],
      "quivr/examples/chatbot_voice/main.py": [
        [
          "main",
          53,
          110,
          89,
          17,
          89,
          29,
          87,
          17,
          90,
          129
        ]
      ],
      "quivr/examples/pdf_document_from_yaml.py": [
        [
          "main",
          27,
          139,
          135,
          9,
          137,
          9,
          133,
          9,
          138,
          17
        ]
      ],
      "quivr/examples/simple_question/simple_question_streaming.py": [
        [
          "main",
          10,
          29,
          24,
          13,
          24,
          53,
          23,
          19,
          24,
          53
        ],
        [
          "main",
          10,
          29,
          29,
          13,
          29,
          62,
          26,
          19,
          29,
          62
        ]
      ],
      "quivr/core/tests/test_config.py": [
        [
          "test_default_retrievalconfig",
          21,
          28,
          26,
          5,
          26,
          44,
          25,
          5,
          28,
          51
        ],
        [
          "test_default_retrievalconfig",
          21,
          28,
          27,
          5,
          27,
          46,
          25,
          5,
          28,
          51
        ]
      ]
    },
    "re.sub": {
      "quivr/core/quivr_core/rag/entities/config.py": [
        [
          "normalize_to_env_variable_name",
          24,
          34,
          26,
          25,
          26,
          59,
          24,
          36,
          29,
          37
        ]
      ]
    },
    "repr": {
      "quivr/core/quivr_core/rag/entities/config.py": [
        [
          "__hash__",
          323,
          338,
          336,
          17,
          336,
          33,
          336,
          17,
          336,
          33
        ]
      ]
    },
    "json.dumps": {
      "quivr/core/tests/fixture_chunks.py": [
        [
          "main",
          14,
          49,
          49,
          25,
          49,
          46,
          44,
          25,
          49,
          54
        ]
      ]
    },
    "warnings.warn": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "get_file_extension",
          20,
          33,
          29,
          9,
          32,
          9,
          28,
          5,
          33,
          31
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "get_file_extension",
          53,
          66,
          62,
          9,
          65,
          9,
          61,
          5,
          66,
          31
        ]
      ]
    },
    "logging.info": {
      "quivr/core/quivr_core/rag/quivr_rag_langgraph.py": [
        [
          "dynamic_retrieve",
          678,
          759,
          714,
          17,
          716,
          17,
          714,
          17,
          716,
          17
        ]
      ]
    },
    "logging.warning": {
      "quivr/core/quivr_core/rag/quivr_rag_langgraph.py": [
        [
          "dynamic_retrieve",
          678,
          759,
          750,
          17,
          753,
          17,
          750,
          17,
          754,
          21
        ],
        [
          "reduce_rag_context",
          844,
          914,
          895,
          17,
          898,
          17,
          895,
          17,
          899,
          21
        ],
        [
          "reduce_rag_context",
          844,
          914,
          909,
          17,
          911,
          17,
          909,
          17,
          912,
          21
        ]
      ]
    }
  },
  "CWE-326": {
    "os.urandom": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          77,
          62,
          77,
          75,
          77,
          62,
          77,
          81
        ]
      ]
    }
  },
  "CWE-327": {
    "hashlib.sha1": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          46,
          21,
          46,
          48,
          43,
          17,
          50,
          17
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          79,
          21,
          79,
          48,
          76,
          17,
          83,
          17
        ]
      ]
    }
  },
  "CWE-329": {
    "uuid.uuid4": {
      "quivr/core/quivr_core/rag/entities/chat.py": [
        [
          "append",
          50,
          68,
          62,
          24,
          62,
          30,
          51,
          9,
          68,
          35
        ]
      ],
      "quivr/core/tests/conftest.py": [
        [
          "quivr_txt",
          26,
          34,
          28,
          12,
          28,
          18,
          26,
          15,
          34,
          5
        ],
        [
          "quivr_txt",
          26,
          34,
          29,
          18,
          29,
          24,
          26,
          15,
          34,
          5
        ],
        [
          "quivr_pdf",
          38,
          46,
          40,
          12,
          40,
          18,
          39,
          12,
          46,
          5
        ],
        [
          "quivr_pdf",
          38,
          46,
          41,
          18,
          41,
          24,
          39,
          12,
          46,
          5
        ]
      ],
      "quivr/core/tests/fixture_chunks.py": [
        [
          "main",
          14,
          49,
          20,
          32,
          20,
          38,
          15,
          24,
          38,
          9
        ],
        [
          "main",
          14,
          49,
          20,
          41,
          20,
          47,
          15,
          24,
          38,
          9
        ]
      ],
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          52,
          14,
          52,
          20,
          51,
          5,
          52,
          10
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          85,
          14,
          85,
          20,
          84,
          5,
          85,
          10
        ]
      ],
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "_init_chats",
          295,
          298,
          296,
          19,
          296,
          25,
          295,
          21,
          298,
          38
        ],
        [
          "afrom_files",
          301,
          372,
          340,
          20,
          340,
          26,
          338,
          9,
          344,
          30
        ],
        [
          "afrom_langchain_documents",
          402,
          453,
          438,
          20,
          438,
          26,
          438,
          20,
          441,
          28
        ]
      ],
      "quivr/core/tests/test_brain.py": [
        [
          "test_brain_from_langchain_docs",
          60,
          71,
          61,
          51,
          61,
          57,
          60,
          42,
          70,
          52
        ],
        [
          "test_brain_search",
          76,
          92,
          79,
          52,
          79,
          58,
          77,
          5,
          88,
          27
        ],
        [
          "test_brain_search",
          76,
          92,
          80,
          52,
          80,
          58,
          77,
          5,
          88,
          27
        ],
        [
          "test_brain_info_empty",
          129,
          151,
          131,
          10,
          131,
          16,
          129,
          27,
          151,
          5
        ]
      ],
      "quivr/core/tests/test_chat_history.py": [
        [
          "test_chat_history_constructor",
          19,
          25,
          20,
          25,
          20,
          31,
          20,
          25,
          23,
          44
        ],
        [
          "test_chat_history_constructor",
          19,
          25,
          20,
          34,
          20,
          40,
          20,
          25,
          23,
          44
        ],
        [
          "test_chat_history_append",
          28,
          34,
          29,
          32,
          29,
          38,
          28,
          30,
          32,
          33
        ],
        [
          "test_chat_history_append",
          28,
          34,
          29,
          41,
          29,
          47,
          28,
          30,
          32,
          33
        ],
        [
          "test_chat_history_get_history",
          37,
          53,
          38,
          32,
          38,
          38,
          37,
          35,
          47,
          25
        ],
        [
          "test_chat_history_get_history",
          37,
          53,
          38,
          41,
          38,
          47,
          37,
          35,
          47,
          25
        ],
        [
          "test_chat_history_iter_pairs_invalid",
          56,
          63,
          60,
          36,
          60,
          42,
          57,
          5,
          63,
          39
        ],
        [
          "test_chat_history_iter_pairs_invalid",
          56,
          63,
          60,
          45,
          60,
          51,
          57,
          5,
          63,
          39
        ],
        [
          "test_chat_history_iter_pais",
          66,
          76,
          67,
          32,
          67,
          38,
          66,
          33,
          76,
          79
        ],
        [
          "test_chat_history_iter_pais",
          66,
          76,
          67,
          41,
          67,
          47,
          66,
          33,
          76,
          79
        ]
      ],
      "quivr/core/tests/processor/docx/test_docx.py": [
        [
          "test_docx_filedocx",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          26
        ],
        [
          "test_docx_filedocx",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          26
        ]
      ],
      "quivr/core/tests/processor/epub/test_epub_processor.py": [
        [
          "test_epub_page_blanche",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          27
        ],
        [
          "test_epub_page_blanche",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          27
        ],
        [
          "test_epub_processor",
          30,
          43,
          33,
          12,
          33,
          18,
          31,
          9,
          43,
          26
        ],
        [
          "test_epub_processor",
          30,
          43,
          34,
          18,
          34,
          24,
          31,
          9,
          43,
          26
        ]
      ],
      "quivr/core/quivr_core/rag/quivr_rag_langgraph.py": [
        [
          "__init__",
          152,
          159,
          156,
          22,
          156,
          28,
          155,
          17,
          157,
          35
        ],
        [
          "filter_history",
          441,
          477,
          458,
          20,
          458,
          26,
          441,
          24,
          460,
          82
        ]
      ],
      "quivr/core/tests/processor/community/test_markdown_processor.py": [
        [
          "test_markdown_processor",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          26
        ],
        [
          "test_markdown_processor",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          26
        ]
      ],
      "quivr/core/tests/processor/odt/test_odt.py": [
        [
          "test_odt_processor",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          26
        ],
        [
          "test_odt_processor",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          26
        ],
        [
          "test_odt_processor_fail",
          30,
          42,
          33,
          12,
          33,
          18,
          31,
          9,
          42,
          39
        ],
        [
          "test_odt_processor_fail",
          30,
          42,
          34,
          18,
          34,
          24,
          31,
          9,
          42,
          39
        ]
      ],
      "quivr/core/tests/test_quivr_file.py": [
        [
          "test_create_file",
          7,
          22,
          8,
          10,
          8,
          16,
          8,
          10,
          19,
          25
        ],
        [
          "test_create_file",
          7,
          22,
          9,
          16,
          9,
          22,
          8,
          10,
          19,
          25
        ],
        [
          "test_create_file_add_metadata",
          25,
          38,
          26,
          10,
          26,
          16,
          26,
          10,
          38,
          45
        ],
        [
          "test_create_file_add_metadata",
          25,
          38,
          27,
          16,
          27,
          22,
          26,
          10,
          38,
          45
        ]
      ],
      "quivr/core/tests/test_quivr_rag.py": [
        [
          "test_quivrqaraglanggraph",
          56,
          100,
          63,
          32,
          63,
          38,
          57,
          5,
          71,
          60
        ],
        [
          "test_quivrqaraglanggraph",
          56,
          100,
          63,
          41,
          63,
          47,
          57,
          5,
          71,
          60
        ]
      ],
      "quivr/core/tests/processor/test_txt_processor.py": [
        [
          "txt_qfile",
          10,
          18,
          12,
          12,
          12,
          18,
          10,
          15,
          18,
          5
        ],
        [
          "txt_qfile",
          10,
          18,
          13,
          18,
          13,
          24,
          10,
          15,
          18,
          5
        ]
      ],
      "quivr/core/tests/processor/pdf/test_unstructured_pdf_processor.py": [
        [
          "test_unstructured_pdf_processor",
          14,
          28,
          19,
          12,
          19,
          18,
          15,
          10,
          28,
          26
        ],
        [
          "test_unstructured_pdf_processor",
          14,
          28,
          20,
          18,
          20,
          24,
          15,
          10,
          28,
          26
        ],
        [
          "test_unstructured_pdf_processor_fail",
          34,
          48,
          39,
          12,
          39,
          18,
          34,
          48,
          48,
          39
        ],
        [
          "test_unstructured_pdf_processor_fail",
          34,
          48,
          40,
          18,
          40,
          24,
          34,
          48,
          48,
          39
        ]
      ],
      "quivr/core/tests/test_utils.py": [
        [
          "test_get_prev_message_incorrect_message",
          18,
          24,
          22,
          75,
          22,
          81,
          19,
          10,
          24,
          48
        ],
        [
          "test_get_prev_message_str",
          27,
          41,
          37,
          24,
          37,
          30,
          29,
          5,
          41,
          61
        ]
      ]
    },
    "os.urandom": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          77,
          62,
          77,
          75,
          77,
          62,
          77,
          81
        ]
      ]
    }
  },
  "CWE-347": {},
  "CWE-377": {
    "open": {
      "quivr/core/quivr_core/base_config.py": [
        [
          "from_yaml",
          27,
          42,
          38,
          14,
          38,
          33,
          27,
          19,
          42,
          33
        ]
      ],
      "quivr/core/quivr_core/config.py": [
        [
          "from_yaml",
          25,
          31,
          27,
          14,
          27,
          33,
          25,
          19,
          31,
          33
        ]
      ],
      "quivr/examples/quivr-whisper/app.py": [
        [
          "transcribe_audio_file",
          117,
          131,
          123,
          14,
          123,
          45,
          117,
          27,
          123,
          45
        ]
      ],
      "quivr/core/tests/conftest.py": [
        [
          "chunks_stream_answer",
          55,
          65,
          56,
          10,
          56,
          56,
          56,
          10,
          60,
          24
        ]
      ],
      "quivr/core/tests/fixture_chunks.py": [
        [
          "main",
          14,
          49,
          27,
          10,
          27,
          36,
          15,
          24,
          38,
          9
        ]
      ],
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "load",
          148,
          206,
          167,
          14,
          167,
          64,
          167,
          14,
          172,
          75
        ],
        [
          "save",
          208,
          272,
          270,
          14,
          270,
          63,
          260,
          23,
          272,
          25
        ]
      ],
      "quivr/examples/chatbot/main.py": [
        [
          "on_chat_start",
          9,
          45,
          26,
          10,
          26,
          47,
          21,
          12,
          45,
          39
        ]
      ],
      "quivr/examples/chatbot_voice/main.py": [
        [
          "on_chat_start",
          13,
          49,
          30,
          10,
          30,
          47,
          25,
          12,
          49,
          39
        ]
      ]
    },
    "tempfile.NamedTemporaryFile": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "transcribe_audio_file",
          117,
          131,
          118,
          10,
          118,
          57,
          117,
          27,
          123,
          45
        ]
      ],
      "quivr/examples/chatbot/main.py": [
        [
          "on_chat_start",
          9,
          45,
          29,
          10,
          31,
          5,
          21,
          12,
          45,
          39
        ]
      ],
      "quivr/examples/chatbot_voice/main.py": [
        [
          "on_chat_start",
          13,
          49,
          33,
          10,
          35,
          5,
          25,
          12,
          49,
          39
        ]
      ],
      "quivr/examples/save_load_brain.py": [
        [
          "main",
          7,
          17,
          8,
          10,
          8,
          61,
          8,
          10,
          17,
          33
        ]
      ],
      "quivr/examples/simple_question/simple_question_streaming.py": [
        [
          "main",
          10,
          29,
          14,
          10,
          14,
          61,
          11,
          19,
          23,
          81
        ]
      ]
    }
  },
  "CWE-502": {
    "yaml.safe_load": {
      "quivr/core/quivr_core/base_config.py": [
        [
          "from_yaml",
          27,
          42,
          39,
          27,
          39,
          48,
          27,
          19,
          42,
          33
        ]
      ],
      "quivr/core/quivr_core/config.py": [
        [
          "from_yaml",
          25,
          31,
          28,
          27,
          28,
          48,
          25,
          19,
          31,
          33
        ]
      ]
    },
    "json.loads": {
      "quivr/core/tests/conftest.py": [
        [
          "chunks_stream_answer",
          55,
          65,
          61,
          31,
          61,
          44,
          60,
          9,
          62,
          28
        ]
      ]
    }
  },
  "CWE-643": {},
  "CWE-760": {
    "uuid.uuid4": {
      "quivr/core/quivr_core/rag/entities/chat.py": [
        [
          "append",
          50,
          68,
          62,
          24,
          62,
          30,
          51,
          9,
          68,
          35
        ]
      ],
      "quivr/core/tests/conftest.py": [
        [
          "quivr_txt",
          26,
          34,
          28,
          12,
          28,
          18,
          26,
          15,
          34,
          5
        ],
        [
          "quivr_txt",
          26,
          34,
          29,
          18,
          29,
          24,
          26,
          15,
          34,
          5
        ],
        [
          "quivr_pdf",
          38,
          46,
          40,
          12,
          40,
          18,
          39,
          12,
          46,
          5
        ],
        [
          "quivr_pdf",
          38,
          46,
          41,
          18,
          41,
          24,
          39,
          12,
          46,
          5
        ]
      ],
      "quivr/core/tests/fixture_chunks.py": [
        [
          "main",
          14,
          49,
          20,
          32,
          20,
          38,
          15,
          24,
          38,
          9
        ],
        [
          "main",
          14,
          49,
          20,
          41,
          20,
          47,
          15,
          24,
          38,
          9
        ]
      ],
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          52,
          14,
          52,
          20,
          51,
          5,
          52,
          10
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          85,
          14,
          85,
          20,
          84,
          5,
          85,
          10
        ]
      ],
      "quivr/core/quivr_core/brain/brain.py": [
        [
          "_init_chats",
          295,
          298,
          296,
          19,
          296,
          25,
          295,
          21,
          298,
          38
        ],
        [
          "afrom_files",
          301,
          372,
          340,
          20,
          340,
          26,
          338,
          9,
          344,
          30
        ],
        [
          "afrom_langchain_documents",
          402,
          453,
          438,
          20,
          438,
          26,
          438,
          20,
          441,
          28
        ]
      ],
      "quivr/core/tests/test_brain.py": [
        [
          "test_brain_from_langchain_docs",
          60,
          71,
          61,
          51,
          61,
          57,
          60,
          42,
          70,
          52
        ],
        [
          "test_brain_search",
          76,
          92,
          79,
          52,
          79,
          58,
          77,
          5,
          88,
          27
        ],
        [
          "test_brain_search",
          76,
          92,
          80,
          52,
          80,
          58,
          77,
          5,
          88,
          27
        ],
        [
          "test_brain_info_empty",
          129,
          151,
          131,
          10,
          131,
          16,
          129,
          27,
          151,
          5
        ]
      ],
      "quivr/core/tests/test_chat_history.py": [
        [
          "test_chat_history_constructor",
          19,
          25,
          20,
          25,
          20,
          31,
          20,
          25,
          23,
          44
        ],
        [
          "test_chat_history_constructor",
          19,
          25,
          20,
          34,
          20,
          40,
          20,
          25,
          23,
          44
        ],
        [
          "test_chat_history_append",
          28,
          34,
          29,
          32,
          29,
          38,
          28,
          30,
          32,
          33
        ],
        [
          "test_chat_history_append",
          28,
          34,
          29,
          41,
          29,
          47,
          28,
          30,
          32,
          33
        ],
        [
          "test_chat_history_get_history",
          37,
          53,
          38,
          32,
          38,
          38,
          37,
          35,
          47,
          25
        ],
        [
          "test_chat_history_get_history",
          37,
          53,
          38,
          41,
          38,
          47,
          37,
          35,
          47,
          25
        ],
        [
          "test_chat_history_iter_pairs_invalid",
          56,
          63,
          60,
          36,
          60,
          42,
          57,
          5,
          63,
          39
        ],
        [
          "test_chat_history_iter_pairs_invalid",
          56,
          63,
          60,
          45,
          60,
          51,
          57,
          5,
          63,
          39
        ],
        [
          "test_chat_history_iter_pais",
          66,
          76,
          67,
          32,
          67,
          38,
          66,
          33,
          76,
          79
        ],
        [
          "test_chat_history_iter_pais",
          66,
          76,
          67,
          41,
          67,
          47,
          66,
          33,
          76,
          79
        ]
      ],
      "quivr/core/tests/processor/docx/test_docx.py": [
        [
          "test_docx_filedocx",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          26
        ],
        [
          "test_docx_filedocx",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          26
        ]
      ],
      "quivr/core/tests/processor/epub/test_epub_processor.py": [
        [
          "test_epub_page_blanche",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          27
        ],
        [
          "test_epub_page_blanche",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          27
        ],
        [
          "test_epub_processor",
          30,
          43,
          33,
          12,
          33,
          18,
          31,
          9,
          43,
          26
        ],
        [
          "test_epub_processor",
          30,
          43,
          34,
          18,
          34,
          24,
          31,
          9,
          43,
          26
        ]
      ],
      "quivr/core/quivr_core/rag/quivr_rag_langgraph.py": [
        [
          "__init__",
          152,
          159,
          156,
          22,
          156,
          28,
          155,
          17,
          157,
          35
        ],
        [
          "filter_history",
          441,
          477,
          458,
          20,
          458,
          26,
          441,
          24,
          460,
          82
        ]
      ],
      "quivr/core/tests/processor/community/test_markdown_processor.py": [
        [
          "test_markdown_processor",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          26
        ],
        [
          "test_markdown_processor",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          26
        ]
      ],
      "quivr/core/tests/processor/odt/test_odt.py": [
        [
          "test_odt_processor",
          13,
          25,
          16,
          12,
          16,
          18,
          14,
          9,
          25,
          26
        ],
        [
          "test_odt_processor",
          13,
          25,
          17,
          18,
          17,
          24,
          14,
          9,
          25,
          26
        ],
        [
          "test_odt_processor_fail",
          30,
          42,
          33,
          12,
          33,
          18,
          31,
          9,
          42,
          39
        ],
        [
          "test_odt_processor_fail",
          30,
          42,
          34,
          18,
          34,
          24,
          31,
          9,
          42,
          39
        ]
      ],
      "quivr/core/tests/test_quivr_file.py": [
        [
          "test_create_file",
          7,
          22,
          8,
          10,
          8,
          16,
          8,
          10,
          19,
          25
        ],
        [
          "test_create_file",
          7,
          22,
          9,
          16,
          9,
          22,
          8,
          10,
          19,
          25
        ],
        [
          "test_create_file_add_metadata",
          25,
          38,
          26,
          10,
          26,
          16,
          26,
          10,
          38,
          45
        ],
        [
          "test_create_file_add_metadata",
          25,
          38,
          27,
          16,
          27,
          22,
          26,
          10,
          38,
          45
        ]
      ],
      "quivr/core/tests/test_quivr_rag.py": [
        [
          "test_quivrqaraglanggraph",
          56,
          100,
          63,
          32,
          63,
          38,
          57,
          5,
          71,
          60
        ],
        [
          "test_quivrqaraglanggraph",
          56,
          100,
          63,
          41,
          63,
          47,
          57,
          5,
          71,
          60
        ]
      ],
      "quivr/core/tests/processor/test_txt_processor.py": [
        [
          "txt_qfile",
          10,
          18,
          12,
          12,
          12,
          18,
          10,
          15,
          18,
          5
        ],
        [
          "txt_qfile",
          10,
          18,
          13,
          18,
          13,
          24,
          10,
          15,
          18,
          5
        ]
      ],
      "quivr/core/tests/processor/pdf/test_unstructured_pdf_processor.py": [
        [
          "test_unstructured_pdf_processor",
          14,
          28,
          19,
          12,
          19,
          18,
          15,
          10,
          28,
          26
        ],
        [
          "test_unstructured_pdf_processor",
          14,
          28,
          20,
          18,
          20,
          24,
          15,
          10,
          28,
          26
        ],
        [
          "test_unstructured_pdf_processor_fail",
          34,
          48,
          39,
          12,
          39,
          18,
          34,
          48,
          48,
          39
        ],
        [
          "test_unstructured_pdf_processor_fail",
          34,
          48,
          40,
          18,
          40,
          24,
          34,
          48,
          48,
          39
        ]
      ],
      "quivr/core/tests/test_utils.py": [
        [
          "test_get_prev_message_incorrect_message",
          18,
          24,
          22,
          75,
          22,
          81,
          19,
          10,
          24,
          48
        ],
        [
          "test_get_prev_message_str",
          27,
          41,
          37,
          24,
          37,
          30,
          29,
          5,
          41,
          61
        ]
      ]
    },
    "os.urandom": {
      "quivr/examples/quivr-whisper/app.py": [
        [
          "upload_file",
          53,
          83,
          77,
          62,
          77,
          75,
          77,
          62,
          77,
          81
        ]
      ]
    },
    "hashlib.sha1": {
      "quivr/core/quivr_core/storage/file.py": [
        [
          "load_qfile",
          36,
          62,
          46,
          21,
          46,
          48,
          43,
          17,
          50,
          17
        ]
      ],
      "quivr/core/quivr_core/files/file.py": [
        [
          "load_qfile",
          69,
          95,
          79,
          21,
          79,
          48,
          76,
          17,
          83,
          17
        ]
      ]
    }
  },
  "CWE-918": {
    "urllib.parse.urlparse": {
      "quivr/core/quivr_core/llm/llm_endpoint.py": [
        [
          "from_config",
          212,
          313,
          228,
          30,
          228,
          58,
          228,
          30,
          228,
          58
        ]
      ]
    },
    "httpx.AsyncClient": {
      "quivr/core/quivr_core/processor/implementations/tika_processor.py": [
        [
          "__init__",
          31,
          52,
          41,
          24,
          41,
          57,
          32,
          9,
          46,
          19
        ]
      ]
    }
  },
  "CWE-943": {},
  "CWE-1333": {
    "re.sub": {
      "quivr/core/quivr_core/rag/entities/config.py": [
        [
          "normalize_to_env_variable_name",
          24,
          34,
          26,
          25,
          26,
          59,
          24,
          36,
          29,
          37
        ]
      ]
    },
    "str.startswith": {
      "quivr/core/quivr_core/rag/entities/config.py": [
        [
          "get_supplier_by_model_name",
          281,
          289,
          286,
          20,
          286,
          52,
          285,
          17,
          286,
          52
        ],
        [
          "get_llm_model_config",
          292,
          305,
          302,
          16,
          302,
          41,
          301,
          13,
          302,
          41
        ]
      ]
    }
  }
}